# CC-Anywhere TODO List

計画・実装時は以下のドキュメントの仕様に従って実装してください。
* https://docs.anthropic.com/ja/docs/claude-code/sdk

## 📋 実装優先順位サマリー

### 実装フェーズの概要
以下の順序で段階的に実装を進めることを推奨します：

#### **Phase 1: 即座に実施（1-2日）** ✅ 完了
- [x] 大規模フロントエンドコンポーネントの分割
- [x] 設定ファイルとスクリプトの整理
- [x] Claude Code SDK session ID問題の修正
- [x] createApp関数の分割
- [x] SDK Continue機能の完全実装

#### **Phase 2: 1週間以内** 🚀 現在のフォーカス
1. ~~**エラーハンドリングの統一** (高優先度)~~ ✅ (2025-07-28 完了)
   - カスタムエラークラスの実装
   - エラーハンドリングミドルウェアの強化
   - 全ルートハンドラのリファクタリング
   - エラーハンドリングガイドライン作成
2. **フロントエンド状態管理の改善**
3. **リポジトリパターンの改善** (中優先度)

#### **Phase 3: 2週間以内**
1. **依存性注入（DI）の実装** (高優先度)
2. **Amazon Bedrock対応** 🚧 (調査済み、実装保留)
   - **調査結果** (2025-07-28):
     - Claude Code SDKはBedrock対応を謳っている
     - 環境変数`CLAUDE_CODE_USE_BEDROCK=1`で切り替え可能
     - 最新モデル名: Opus 4, Sonnet 4, Haiku 3.5
   - **実装状況**:
     - backend実装は最新モデル名に更新済み
     - テストコード作成済み
   - **問題点**:
     - モデルID/ARN形式の問題でタイムアウトが発生
     - 推論プロファイルの指定方法が不明確
   - **今後の対応**:
     - SDKのBedrock対応が安定するまで保留
     - 通常のAPIキー経由での動作を前提とする
3. **サブエージェント機能の対応** (高優先度 🔴)

#### **Phase 4: 1ヶ月以内**
1. **WebSocket処理の最適化** (中優先度)
2. **型定義の共有** (中優先度)
3. **Claude Code SDK新機能の活用とセキュリティ強化** (高優先度 🔴)
4. **ドキュメント構造の再編成**

#### **Phase 5: 継続的改善**
- データベースマイグレーションシステム
- セキュリティの強化（レート制限、APIキーハッシュ化）
- キャッシュレイヤーの追加
- テストカバレッジの改善
- APIドキュメントの自動生成
- ログシステムの改善（OpenTelemetry）

## 優先テスト

* ✅ セッション継続テスト(会話の継続) - 完了済み

## 🔧 修正が必要な問題

### バックエンドアーキテクチャの技術的負債
1. ~~**createApp関数の肥大化**~~ ✅ (2025-07-28 解決済み)
2. **依存性の密結合** - DIコンテナ未実装でテスタビリティが低い
3. ~~**エラーハンドリングの重複**~~ ✅ (2025-07-28 解決済み)
   - 統一されたエラークラス階層を実装
   - エラーハンドリングミドルウェアで中央集権化
   - 各ルートは単にエラーをthrowするだけに簡素化
4. **データベースマイグレーション** - コンストラクタ内に全ロジックが埋め込まれている

## 🎯 優先実装したい機能

### 最優先度 🔥

1. **プロダクションビルドでlocalhost:5000でアクセスするとエラーになる。そもそも必要かどうかの検討**
   - 現状の問題点を調査
   - 本番環境でのlocalhost:5000へのアクセスの必要性を検討
   - 必要な場合は修正、不要な場合は適切なエラーハンドリングを実装

2. **レスポンシブデザイン完全対応** ✅ (2025-07-28 完了)
   - すべての画面でモバイル対応を実装
   - タスク詳細画面のタブ/アコーディオン切り替え
   - ナビゲーションのモバイルメニュー対応
   - テーブルのスクロール対応
   - フォームの最適化

3. **Amazon Bedrock対応** 🚧 (調査済み、実装保留)
   - **重要**: 通常のAPIキー経由での動作を優先

4. **Web UI アーキテクチャの再構築** ✅ (2025-07-23 完了)
   - SvelteKit + shadcn-svelteへの移行完了
   - **実装内容**:
     - Svelte 5 (Runes対応) + SvelteKitでフロントエンドを再構築
     - shadcn-svelteによるUIコンポーネントシステム
     - TypeScriptによる完全な型安全性
     - Viteベースの高速ビルドシステム
     - APIクライアント層の実装（Axios使用）
     - WebSocketクライアントの実装（自動再接続対応）
   - **ドキュメント整備**:
     - Svelte 5初学者向け包括的ガイド作成
     - shadcn-svelte使用ガイド
     - アーキテクチャ解説
     - 実装例とトラブルシューティング
   - **残課題**:
     - スケジューラーUIの実装
     - 設定画面の実装
     - 他のAPIエンドポイントの型整合性修正

5. **バックエンド アーキテクチャのリファクタリング**
   - **レイヤードアーキテクチャの徹底**:
     - Controller層: HTTPリクエスト/レスポンスの処理
     - Service層: ビジネスロジックの実装
     - Repository層: データアクセスの抽象化
     - Domain層: ビジネスエンティティの定義
   - **依存性注入（DI）の導入**:
     - tsyringe または InversifyJS の採用
     - テスタビリティの向上
   - **エラーハンドリングの統一**:
     - カスタムエラークラスの階層化
     - エラーミドルウェアの強化
   - **データベース層の改善**:
     - TypeORMまたはPrismaへの移行検討
     - マイグレーション管理の自動化
   - **キューシステムの最適化**:
     - BullMQへの移行検討
     - ジョブの優先度管理強化

6. **Claude Code SDK `continue`オプションの対応** ✅ (2025-07-28 完全実装)
   - SDK Continue機能の完全実装により、会話履歴の継続が可能に
   - `continueFromTaskId`指定で自動的に最新セッションIDを使用
   - Claude Code SDK仕様（resumeSession時に新セッションID生成）への対応
   - セッションIDチェーン追跡により、複数タスクにわたる会話継続を実現

### 高優先度 🔴

7. **サブエージェント機能の対応**
   - Claude Code SDK v1.0.60で追加されたサブエージェント機能の調査・実装
   - サブエージェント情報を取得できるAPIの実装
   - プロジェクトレベル（`.claude/agents/`）のサブエージェント管理
   - サブエージェントの作成・編集・削除機能
   - Web UIでのサブエージェント選択機能
   - カスタムシステムプロンプトを使用したサブエージェントのシミュレーション

8. **Claude Code SDK新機能の活用とセキュリティ強化**
   - **権限管理の強化**:
     - allowedTools/disallowedToolsによる詳細なツール制限
     - 権限モードの拡張（readonly, restricted, custom）
     - 危険なコマンドの自動検出とブロック
   - **環境変数管理**:
     - タスクごとのカスタム環境変数設定
     - 秘密値の安全な管理（secrets参照）
     - 実行環境の分離（clean/inherit）
   - **リアルタイムツール承認**:
     - WebSocket経由の承認フロー実装
     - 高リスク操作の事前承認機能
     - 承認履歴の記録と監査
   - **エラー監視強化**:
     - stderrキャプチャによるエラー検出
     - エラーパターンの自動分析
     - リアルタイムアラート機能
   - **タスクテンプレート**:
     - 事前定義された安全な設定テンプレート
     - code-review, refactoring, deploymentなどのプリセット
     - カスタムテンプレートの作成・共有

9. **開発者体験（DX）の向上**
   - **API ドキュメントの自動生成**:
     - OpenAPI/Swagger の導入
     - TypeDoc によるコードドキュメント生成
   - **開発環境の改善**:
     - Docker Compose による統一開発環境
     - ホットリロードの最適化
     - デバッグ設定の共有（.vscode/launch.json）
   - **CI/CD パイプラインの構築**:
     - GitHub Actions による自動テスト
     - 自動リリースワークフロー
     - コードカバレッジの可視化

10. **モニタリング・可観測性の強化**
    - **構造化ログの改善**:
      - OpenTelemetry の導入
      - トレーシングの実装
    - **メトリクスの収集**:
      - Prometheus互換メトリクス
      - カスタムメトリクスの定義
    - **ヘルスチェックエンドポイント**:
      - 詳細な依存関係チェック
      - Kubernetes対応のreadiness/liveness probe

11. **逐次実行モード**
    - 複数タスクの順次実行
    - 前のタスクの結果を次のタスクに渡す
    - パイプライン機能

### 中優先度 🟡

12. **テスト戦略の強化**
    - **E2Eテストの導入**:
      - Playwright によるUI自動テスト
      - APIシナリオテスト
    - **統合テストの拡充**:
      - WebSocketテストの改善
      - データベース統合テスト
    - **パフォーマンステスト**:
      - 負荷テストの自動化
      - ベンチマークスイート

13. **タスクテンプレート機能**（一部8.で実装予定）
    - よく使うタスクをテンプレート化
    - パラメータ化されたテンプレート

14. **実行結果の可視化**
    - 統計ダッシュボード
    - 実行時間の分析
    - エラー率の可視化

15. **認証・権限管理の強化**
    - ユーザー管理機能
    - ロールベースアクセス制御
    - APIキーの詳細な権限設定

### 低優先度 🟢

1. **インタラクティブな確認処理** - WebSocketを活用した双方向通信 [PENDING]
   - Claude Code SDKの確認プロンプトに対する応答機能
   - リアルタイムでの承認/拒否の送信
   - 確認履歴の記録と表示
   - タイムアウト設定とリトライ機能
   - **注意**: 現在のClaude Code SDKにはプログラム的な確認APIが存在しないため、実装は時期尚早
   - **待機事項**: SDKがインタラクティブな確認のためのコールバックAPIを提供するまで保留

2. **Claude Code SDK 1.0.51の新機能活用**
   - **Webサーチ機能の統合** - タスク実行時にWeb検索を実行可能に
   - **@メンション機能** - プロンプトで@を使ってファイルを参照
   - **Todoリスト機能の活用** - SDKのTodoリスト機能をWeb UIで可視化
   - **/doctor診断機能** - SDK設定の診断結果をAPIで提供
   - **並列Web検索** - 複数のWeb検索を並列実行
   - **MCPサーバー実行** - ワンオフMCPサーバーの実行サポート
   - **プログレスメッセージ改善** - Bashツールの進捗表示を活用

3. **`permissionPromptTool`** - カスタム権限確認ツール
   - カスタム権限確認ロジックの実装
   - 高度なセキュリティ要件への対応

4. **ストリーミング入力サポート**
   - 大規模な入力データのストリーミング処理
   - メモリ効率の改善

5. **多言語対応**
   - コメントを英語化
   - ドキュメントを英日両方用意
   - WEBページをロケールにより切り替え可能にする

## 🔨 リファクタリング項目（refactor.mdより統合）

### バックエンドの技術的改善

1. **createApp関数の分割** ✅ (2025-07-28 完了)
   - 各setupモジュールを独立したファイルに分割
   - デコレータパターンでFastifyインスタンスを拡張
   - 各モジュール30-50行程度に縮小

2. **依存性注入（DI）の実装** (Phase 3)
   - 現状: 具体的な実装への直接依存が多数存在
   - 改善案: tsyringeまたはInversifyJSを使用した依存性注入コンテナの導入
   - 影響範囲: 全体のアーキテクチャ
   - 実装工数: 5-7日

3. **エラーハンドリングの統一** (Phase 2)
   - 現状: 各ルートハンドラで同様のエラーハンドリングが重複
   - 改善案: 中央集権的なエラーハンドリングミドルウェアとカスタムエラークラスの階層化
   - 影響範囲: 全APIエンドポイント
   - 実装工数: 2-3日

4. **リポジトリパターンの改善** (Phase 2)
   - 現状: リポジトリ実装に重複コードが多い
   - 改善案: ジェネリックな基底リポジトリクラスの作成
   - 影響範囲: データアクセス層
   - 実装工数: 2-3日

5. **WebSocket処理の最適化** (Phase 4)
   - 現状: 全クライアントへのブロードキャスト、メッセージハンドリングの重複
   - 改善案: ルームベースのブロードキャスト、メッセージハンドラーレジストリパターン
   - 影響範囲: リアルタイム通信機能
   - 実装工数: 3-4日

6. **型定義の共有** (Phase 4)
   - 現状: フロントエンドとバックエンドで型定義が重複
   - 改善案: shared/ディレクトリの活用、共有型定義パッケージの作成またはコード生成
   - 影響範囲: 型システム全体
   - 実装工数: 2日

7. **データベースマイグレーションシステム** (Phase 5)
   - 現状: コンストラクタ内に全マイグレーションロジックが埋め込まれている
   - 改善案: 個別のマイグレーションファイルとバージョン管理システムの導入
   - 影響範囲: データベース初期化処理
   - 実装工数: 3-4日

8. **セキュリティの強化** (Phase 5)
   - 現状: APIキーの直接チェック、レート制限なし、入力検証の不統一
   - 改善案: 
     - レート制限の実装
     - APIキーのハッシュ化
     - 統一されたバリデーションミドルウェア
   - 影響範囲: 認証・認可システム
   - 実装工数: 3-4日

9. **キャッシュレイヤーの追加** (Phase 5)
   - 現状: データベースクエリの最適化なし
   - 改善案: Redisベースのキャッシュレイヤー実装
   - 影響範囲: パフォーマンス
   - 実装工数: 4-5日

### フロントエンドの技術的改善

1. **状態管理の改善** (Phase 2)
   - 現状: 各コンポーネントでローカルステートを管理
   - 改善案: 
     - グローバルな状態管理ストアの導入
     - WebSocketメッセージとの同期を一元化
     - Svelte 5のRunesを活用した効率的な状態管理
   - 実装工数: 4-5日

### ドキュメント構造の改善 (Phase 4)

1. **docs/ディレクトリの再構築**
   - 現状: 16個のサブディレクトリで過度に細分化
   - 改善案:
     ```
     docs/
     ├── getting-started/     # クイックスタート、セットアップ
     ├── architecture/        # 全体設計、技術スタック
     ├── api/                # API仕様
     ├── development/        # 開発ガイド（フロント・バック統合）
     ├── operations/         # 運用・デプロイ
     └── CHANGELOG.md        # 変更履歴
     ```
   - 実装工数: 2-3日

## 🚀 最近の実装成果

### SDK Continue機能の完全実装 ✅ (2025-07-28)
- **問題**: 会話履歴が引き継がれない、セッションIDが保存されない
- **実装内容**:
  - Claude Code SDKの実行結果からセッションIDを正しく抽出・保存
  - SDK messagesを会話履歴として保存・APIレスポンスに追加
  - `getLatestSdkSessionId`メソッドでタスクチェーンの最新セッションIDを自動追跡
  - Claude Code SDK仕様（resumeSession時に新セッションID生成）への対応
  - `continueFromTaskId`指定で自動的に最新セッションIDを使用
- **結果**: 完全な会話の継続が可能に
- **関連ファイル**:
  - `/backend/src/claude/claude-code-client.ts`
  - `/backend/src/claude/executor.ts`
  - `/backend/src/repositories/task-repository-adapter.ts`
  - `/backend/src/server/routes/tasks.ts`
  - `/backend/src/queue/task-queue.ts`

### createApp関数の分割 ✅ (2025-07-28)
- **問題**: 293行の巨大関数で責務が混在
- **実装内容**:
  - `setupServices()` - サービス層の初期化
  - `setupMiddleware()` - ミドルウェア登録
  - `setupRoutes()` - ルート登録
  - `setupWebSocket()` - WebSocket設定
  - `setupScheduler()` - スケジューラー設定
  - `setupWorkerMode()` - ワーカーモード設定
  - `setupGracefulShutdown()` - グレースフルシャットダウン
  - デコレータパターンでFastifyインスタンスを拡張
- **結果**: 各モジュール30-50行程度に分割、責務が明確化
- **関連ファイル**:
  - `/backend/src/server/app.ts`
  - `/backend/src/server/setup/` ディレクトリ配下の各モジュール

### 継続タスクでの作業ディレクトリ指定 ✅ (2025-07-28)
- **実装内容**:
  - 継続タスク作成時に別の作業ディレクトリを指定可能に
  - APIエンドポイントで自動的にクロスリポジトリ継続を許可
  - フロントエンドUIに作業ディレクトリ変更オプションを追加
- **使用例**:
  - 前のタスクで学習した内容を別のプロジェクトに適用
  - テンプレートやサンプルコードを参考に新しいプロジェクトを作成
  - 複数のリポジトリにまたがる作業
- **関連ファイル**:
  - `/backend/src/server/routes/tasks.ts:880`
  - `/frontend/src/routes/tasks/[id]/continue/+page.svelte`
  - `/docs/features/continue-task.md`

### Claude Code SDK session ID問題の修正 ✅ (2025-07-25)
- **問題**: SDKが`session_id`（snake_case）を返すが、コードは`sessionId`（camelCase）を探していた
- **影響**: セッションIDが保存されず、SDK continue機能が動作しない
- **修正内容**:
  - ClaudeCodeClientで`session_id`フィールドを正しく抽出するよう修正
  - 単体テスト・統合テストのモックデータを修正
  - SDK continue機能の動作を確認
- **関連ファイル**:
  - `/backend/src/claude/claude-code-client.ts:115-117`
  - `/backend/tests/unit/claude/sdk-session.test.ts`
  - `/backend/tests/integration/sdk-continue.test.ts`

### フロントエンドコンポーネントの分割 ✅ (2025-07-25)
- **routes/tasks/+page.svelte**: 372行から75行に削減（約80%削減）
  - TaskListコンポーネント（46行）：タスク一覧のコンテナ
  - TaskListItemコンポーネント（68行）：個別タスクの表示行
  - TaskPaginationコンポーネント（32行）：ページネーション
  - task-list.svelte.tsストア（205行）：WebSocket処理とタスク状態管理
- **routes/scheduler/+page.svelte**: 299行から114行に削減（約62%削減）
  - ScheduleListコンポーネント（40行）：スケジュール一覧のコンテナ
  - ScheduleItemコンポーネント（115行）：個別スケジュールの表示
  - SchedulePaginationコンポーネント（45行）：ページネーション
  - ScheduleFilterコンポーネント（40行）：ステータスフィルター
  - schedule-list.svelte.tsストア（60行）：スケジュール状態管理

### フロントエンドの全面的な再構築 ✅ (2025-07-23)
- **Svelte 5 + SvelteKitへの移行完了**
  - バニラJavaScriptからSvelte 5 (Runes対応)への完全移行
  - shadcn-svelteによる統一されたUIコンポーネントシステム
  - TypeScriptによる型安全な実装
  - Static Adapterを使用したSPAモード構築
- **アーキテクチャの改善**
  - APIクライアント層の実装（Axios使用）
  - サービス層によるビジネスロジックの分離
  - WebSocketクライアントの実装（自動再接続、状態管理）
  - Svelte 5のRunesによるリアクティブな状態管理
- **実装済み画面**
  - ダッシュボード（タスク統計、WebSocket接続状態表示）
  - タスク一覧（ページネーション、フィルタリング）
  - タスク詳細（リアルタイムログ表示）
  - API Explorer（タスク作成フォーム）
  - ログビューア（リアルタイムログストリーミング）
- **開発環境の整備**
  - Vitestによるテスト環境構築
  - ESLint + Prettierによるコード品質管理
  - svelte-checkによる型チェック
  - ホットリロード対応の開発サーバー
- **包括的なドキュメント作成**
  - Svelte 5基礎ガイド（Runes、イベントハンドリング）
  - shadcn-svelte基礎ガイド（コンポーネント使用法）
  - アーキテクチャ解説
  - 実装例とトラブルシューティング
  - テストガイド

### WebSocket接続とログ表示の改善 ✅ (2025-07-17)
- WebSocketハートビート機能の修正
  - クライアント側からpingメッセージを送信する仕様に変更
  - サーバー側のpong応答を適切に処理
  - 接続タイムアウトエラーを解消
- Claude Code SDK実行ログの完全表示
  - すべてのツール実行（tool:start, tool:end）をリアルタイム表示
  - Claude応答メッセージ（claude:response）の表示
  - タスク進捗（task:progress）の表示
  - TodoWriteツールの更新内容を詳細表示
- ターン進捗の全ターン表示
  - 初回ターンだけでなく、すべてのターンで進捗を表示
  - `turnCount === 1`条件を削除し、全ターンで送信
- ログメッセージのスタイリング改善
  - メッセージタイプごとに色分けとアイコン表示
  - ツール別の視覚的な識別（Read: 青、Bash: 紫、Edit: 緑など）
  - HTMLエスケープ処理の追加でセキュリティ向上

### フロントエンドアーキテクチャの全面改善 ✅ (2025-07-16)
- モジュラーなJavaScriptアーキテクチャを実装
  - `logger.js` - 構造化されたフロントエンドロギングシステム
  - `websocket-manager.js` - 中央集権的なWebSocket接続管理（自動再接続、イベント駆動）
  - `state-manager.js` - グローバル状態管理システム
  - `error-handler.js` - 統一されたエラーハンドリング機構
- バグ修正
  - タスク詳細モーダルのキャッシュ問題を修正
  - タスク統計の0%成功率表示を修正（ツール未使用時は"N/A"を表示）
  - WebSocketサブスクリプション管理を改善
- WebSocketイベントの拡充
  - `task:tool:start` / `task:tool:end` - ツール実行の詳細追跡
  - `task:claude:response` - Claude応答のリアルタイム表示
  - `task:statistics` - タスク統計情報の更新
  - `todo:update` - TODO進捗の追跡
- タスク詳細モーダルのキャッシュ問題を修正
- タスク統計の0%成功率表示を修正（ツール未使用時は"N/A"を表示）

### フロントエンドのリファクタリング ✅ 
- JavaScript共通関数をutils.jsに集約
  - クエリパラメータ処理、HTML エスケープ、日時フォーマット
  - 通知表示、ナビゲーションリンク更新、接続状態監視
- CSS共通スタイルをcommon.cssに集約
  - 通知、接続状態、モーダル、ボタン、フォーム、ページネーション
- コードの重複を大幅に削減
- メンテナンス性の向上

### スケジューラー機能のUI改善 ✅ 
- タスク実行画面とスケジューラー画面のスタイルを完全に統一
- ナビゲーションリンクにクエリパラメータを引き継ぐ機能を追加
- 接続状態チェックのエンドポイントを修正
- 不要なファイルを削除（index-simple.html, app-simple.js）

### タイマー投稿（スケジュール実行）機能 ✅
- Cron式による定期実行（5フィールド形式）
- ワンタイム実行（指定日時での1回限り実行）
- タイムゾーン対応（Cronスケジュール）
- 実行履歴の記録と管理
- スケジュールの有効化/無効化
- REST APIによる完全な管理機能
- Web UIからのスケジュール管理
- 詳細: [スケジューラー機能ドキュメント](./docs/features/scheduler.md)

### 権限モード実装の改善
- Claude Code SDKの権限モードを正しく実装
- `ask` → `default`, `allow` → `bypassPermissions`, `deny` → `plan` へのマッピング
- Web UIも SDK に合わせて更新（default, acceptEdits, bypassPermissions, plan）
- cc-anywhere経由でもファイル作成が可能に（permissionMode: "allow"指定で）

### タスク実行ログ・結果表示の改善 ✅
- ツール使用情報の詳細表示（Read/Write/Edit/Bash等）をリアルタイムで実装
- タスク実行サマリーの生成（使用ツール統計、ファイル操作一覧、実行時間等）
- WebSocket経由で構造化されたログ情報（tool_usage, progress, summary）を送信
- 各ツールにアイコンを設定（📖読取、✏️作成、📝編集、💻コマンド等）
- エラー時の詳細情報表示の改善
- Markdown形式の結果を適切にレンダリング
- ネストされたJSONレスポンス（task.result.result）に対応

### 自己組織化型並列実行
- 司令塔パターンによるタスクの自律的な並列実行を実現
- タスクがHTTP API経由で他のタスクを作成・管理
- Git worktreeを使用した独立環境での安全な並列実行
- 詳細: [自己組織化型並列実行ドキュメント](./docs/self-organized-parallel-execution.md)

## 📋 実装済み機能一覧

<details>
<summary>Claude Code SDK オプション（全実装済み）</summary>

### 基本オプション ✅
- `maxTurns` - 会話ターン数の制限（1-50）
- `allowedTools` / `disallowedTools` - ツール使用の制限
- `systemPrompt` - カスタムシステムプロンプト（最大10,000文字）
- `permissionMode` - 編集権限の制御（ask/allow/deny/plan）
- `executable` / `executableArgs` - 実行環境の指定
- `mcpConfig` - Model Context Protocol設定
- `continueSession` / `resumeSession` - セッション継続機能
- `verbose` - 詳細ログ出力

### プリセット管理 ✅
- 設定の保存/読み込み機能
- システムプリセットとユーザープリセット
- Web UIからの管理機能

### Web UI改善 ✅
- SDKオプション対応版をデフォルトに
- レスポンシブデザイン対応
- スマートフォン操作性向上

### タスク一覧のページネーション ✅
- APIレベルでのページング対応
- Web UIでのページナビゲーション
- 表示件数選択機能（10, 20, 50, 100件）
- 大量タスク時のパフォーマンス改善

</details>

## 🛠️ その他の改善項目

### Web UI改善 ✅
- Svelte 5 + SvelteKitへの完全移行（2025-07-23）
- shadcn-svelteによるモダンなUIコンポーネント
- TypeScriptによる型安全な実装
- レスポンシブデザイン対応
- フロントエンドのリファクタリング実施（2025-07-14）
- タスク実行画面とスケジューラー画面のスタイル統一（2025-07-14）

### エラーハンドリングの強化
- Claude Code SDK特有のエラーパターンへの対応
- より詳細なエラーメッセージの提供
- エラーリカバリー機能

### パフォーマンスの最適化
- 大規模プロジェクトでの実行速度改善
- メモリ使用量の削減
- 並列実行の効率化

### セキュリティの強化
- API認証の改善
- ツール実行権限の細かい制御
- 監査ログ機能

## 📝 Git Worktree機能の動作仕様

### 基本動作
- Worktreeは独立した作業ディレクトリとして作成
- メインリポジトリとは別の場所で作業を実行
- デフォルトではタスク完了後に自動クリーンアップ

### クリーンアップ時の動作
1. **デフォルト動作**（autoCleanup: true）
   - 未コミットの変更は自動的にパッチファイルとして保存
   - パッチは `.worktree-backups/` ディレクトリに保存
   - worktreeとブランチは削除

2. **keepAfterCompletion有効時**
   - Worktreeは削除されない
   - 作成・修正したファイルはそのまま保持
   - 手動でコミット・マージ等の操作が可能

### 設定例
```typescript
{
  options: {
    worktree: {
      enabled: true,
      branchName: "feature/task-123",
      keepAfterCompletion: true  // タスク完了後も保持
    }
  }
}
```