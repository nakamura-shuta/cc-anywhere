# CC-Anywhere TODO List

計画・実装時は以下のドキュメントの仕様に従って実装してください。
* https://docs.anthropic.com/ja/docs/claude-code/sdk

## ✅ 実装済み機能

### Claude Code SDK オプションパラメータ対応

以下のSDKオプションは実装済みです：

#### 優先度: 高 🔴 - 実装済み ✅

1. **`maxTurns`** - 会話ターン数の制限
   - Web UIとAPIで動的に指定可能
   - スライダーUIで1-50の範囲で設定可能

2. **`allowedTools` / `disallowedTools`** - ツール使用の制限
   - 許可/禁止するツールをUIで選択可能
   - カスタムツールの指定も対応

3. **`systemPrompt`** - カスタムシステムプロンプト
   - タスクごとにシステムプロンプトを指定可能
   - 最大10,000文字まで対応

4. **`permissionMode`** - 編集権限の制御
   - ask/allow/deny/planモードに対応
   - トグルボタンUIで簡単に切り替え可能

#### 優先度: 中 🟡 - 実装済み ✅

5. **`executable` / `executableArgs`** - 実行環境の指定
   - node/python/bashから選択可能
   - 高度な設定で変更可能

6. **`mcpConfig`** - Model Context Protocol設定
   - JSON形式でMCPサーバー設定を指定可能
   - リアルタイムバリデーション付き

7. **`continueSession` / `resumeSession`** - セッション継続機能
   - 前回のセッションを継続するオプション対応

8. **出力形式オプション**
   - text/json形式の選択に対応
   - 高度な設定で変更可能

9. **`verbose`** - 詳細ログ出力
   - 詳細ログ表示のオン/オフ切り替え可能

### プリセット管理機能 ✅

- 設定の保存/読み込み機能を実装
- システムプリセットとユーザープリセットの管理
- Web UIからプリセットの作成・適用・削除が可能

### Web UI の改善 ✅

- SDKオプション対応版をデフォルトに変更
- レスポンシブデザイン対応
- スマートフォンでの操作性向上

## 今後の実装予定

### 優先度: 低 🟢

#### 1. `permissionPromptTool` - カスタム権限確認ツール
- **現状**: 未対応
- **必要な対応**: カスタム権限確認ロジックの実装
- **理由**: 高度なセキュリティ要件への対応

#### 2. ストリーミング入力サポート
- **現状**: 未対応
- **必要な対応**: 大規模な入力データのストリーミング処理
- **理由**: メモリ効率の改善

#### 3. `pathToClaudeCodeExecutable` - カスタム実行パス
- **現状**: 未対応
- **必要な対応**: Claude Code実行ファイルのパス指定
- **理由**: 特殊な環境での実行サポート

### その他の改善項目

#### 1. エラーハンドリングの強化
- Claude Code SDK特有のエラーパターンへの対応
- より詳細なエラーメッセージの提供

#### 2. パフォーマンスの最適化
- 大規模プロジェクトでの実行速度改善
- メモリ使用量の削減

#### 3. セキュリティの強化
- API認証の改善
- ツール実行権限の細かい制御

## Git Worktree機能の動作仕様 📝

### 基本動作
- Worktreeは独立した作業ディレクトリとして作成
- メインリポジトリとは別の場所で作業を実行
- デフォルトではタスク完了後に自動クリーンアップ

### クリーンアップ時の動作
1. **デフォルト動作**（autoCleanup: true）
   - 未コミットの変更は自動的にパッチファイルとして保存
   - パッチは `.worktree-backups/` ディレクトリに保存
   - worktreeとブランチは削除

2. **keepAfterCompletion有効時**
   - Worktreeは削除されない
   - 作成・修正したファイルはそのまま保持
   - 手動でコミット・マージ等の操作が可能

### 設定例
```typescript
{
  options: {
    useWorktree: true,
    worktree: {
      branchName: "feature/task-123",
      keepAfterCompletion: true  // タスク完了後も保持
    }
  }
}
```