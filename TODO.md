# TODO

## 🔴 最優先

### テスト環境の強化
- E2E/統合テストの拡充 - システム全体の品質保証のため
- パフォーマンステスト追加 - 大規模タスクでの性能確保のため

### コードの重複削減
- ProgressFormatterクラス作成 - 進捗フォーマット処理を共通化
- WebSocketBroadcaster統合 - 20以上のbroadcastメソッドを1つに統合
- BaseTaskExecutor導入 - タスク実行ロジックの共通化

## 🟡 高優先度

### Codex対応機能
- **Phase 0: SDK動作検証** - ✅ 完了（2025-10-14）
  - Codex SDK基本動作検証完了
  - ストリーミングモード動作確認
  - ファイル操作テスト成功
  - Phase 0検証レポート作成: `.work/codex/codex-sdk-verification-report.md`
  - Go判定（確定）: ストリーミングモードで全機能利用可能
- **Phase 1: 設計とアーキテクチャ** - ✅ 完了（2025-10-14）
  - [x] IAgentExecutorインターフェイス設計完了
  - [x] リファクタリング計画策定完了
  - [x] データベーススキーマ設計完了
  - [x] API仕様確定
  - 設計ドキュメント: `.work/codex/phase1-*.md`
- **Phase 2: 実装** - ✅ 完了（2025-10-16）
  - [x] Phase 1.1: インターフェイス定義実装（1日）
  - [x] Phase 1.2: CodexAgentExecutor実装（2日）
  - [x] Phase 1.3: ClaudeAgentExecutor実装（2日）
  - [x] Phase 1.4: 統合とテスト（2日）
  - [x] Phase 1.5: フロントエンド対応（1日）
  - 詳細: `.work/codex/phase1-summary.md`
- **既知の問題**
  - [ ] Codexタスク実行時のParameterが作用していないケースがある
    - 調査が必要: どのパラメータが影響を受けているか特定
    - 影響範囲: タスク実行オプションの一部が無視される可能性
  - [ ] WebSocketによるレスポンスの受信ができていない
    - 症状: リアルタイムイベントストリームが正しく配信されない
    - 優先度: 高（ユーザー体験に直接影響）
    - 調査範囲: backend/src/agents/codex-agent-executor.ts のイベント変換ロジック

### Claude Agent SDK新機能対応
- **スラッシュコマンド機能の再評価** - Agent SDK将来バージョンでの改善待ち
  - 現状: SDK 0.1.1ではプロジェクトローカル/グローバル共に動作せず
  - 調査結果: backend/src/claude/executor.ts:158-181のTODOコメント参照
  - 詳細ドキュメント: .work/sandbox/slash-command-investigation-result.md
  - 対処: 通常のタスク指示として実行（例: "Run: cd /path && ./command"）
  - 将来対応: Agent SDKバージョンアップ時に再テスト・実装検討
- **サブエージェント対応** - マルチエージェントワークフローの実装
  - 参考: https://docs.claude.com/en/api/agent-sdk/subagents
  - 動的なサブエージェント追加（--agentsフラグ相当）
  - エージェント間の連携・タスク分担
- additionalDirectories実装 - マルチプロジェクト/モノレポ対応

### タスクグループUI実装
- フロントエンドに複数タスク作成UI追加 - ユーザビリティ向上のため
- タスクグループのプリセット保存機能 - 頻繁な操作の効率化
- 実行履歴表示機能 - 過去の実行結果の確認

### モバイル最適化
- Android Chrome環境の最適化 - モバイルユーザビリティ向上
- タッチ操作・スワイプジェスチャー対応 - スマホ操作性改善

## 🟢 中優先度

### アーキテクチャ改善
- 依存性注入（DI）導入 - テスタビリティとメンテナンス性向上
- リポジトリパターンの改善 - コード重複の削減
- 型定義の共有化 - フロントエンド/バックエンド間の整合性

### 認証・セキュリティ
- JWT認証の本格実装 - セキュアなAPI利用
- ロールベースアクセス制御 - 権限管理の細分化
- レート制限実装 - APIの悪用防止

### 監視・運用
- OpenTelemetry導入 - 可観測性の向上
- Prometheusメトリクス追加 - パフォーマンス監視
- ヘルスチェック強化 - システム状態の可視化

## ⚪ 低優先度

### 長期的な拡張
- 条件分岐・ループ処理サポート - ワークフロー機能の拡張
- ビジュアルエディタ実装 - ノーコードでのタスク構築
- 多言語対応（i18n） - グローバル展開準備

### データベース改善
- TypeORM/Prisma移行検討 - ORM導入による開発効率化
- Redisキャッシュ実装 - パフォーマンス向上
- マイグレーション自動化 - デプロイ効率化

## ✅ 完了済み

- **カスタムスラッシュコマンド対応** - Agent SDK標準機能に統合（2025-10-01）
  - 独自実装（InstructionProcessor等）を削除し、Agent SDKネイティブ機能に統合
  - `/project:`および`/user:`プレフィックスによるコマンド実行をサポート
  - 1,375行のコード削減、統合テスト追加
- **Claude Agent SDKへの移行** - @anthropic-ai/claude-agent-sdk@0.1.1に移行（2025-09-30）
- **Claude Code SDK 2.0.1対応** - 最新版へのメジャーアップグレード（2025-01-30）
- **スケジューラーバグ修正** - 有効/無効切り替え機能の修正（2025-01-30）
- **OpenAPI仕様更新** - v1.0.0、SDK情報更新（2025-01-30）
- OpenAPI/Swagger統合 - APIドキュメント自動生成
- システムテスト環境構築 - Playwright基盤整備
- 環境変数整理 - 不要な設定削除
- タスクグループ実装 - 複数タスク順次・並列実行