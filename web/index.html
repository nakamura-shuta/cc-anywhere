<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CC-Anywhere</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style-advanced.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>CC-Anywhere</h1>
            <div class="header-controls">
                <nav class="header-nav">
                    <a href="/" class="active">„Çø„Çπ„ÇØÂÆüË°å</a>
                    <a href="/scheduler.html">„Çπ„Ç±„Ç∏„É•„Éº„É©„Éº</a>
                </nav>
                <div id="connection-status" class="status disconnected">
                    <span class="status-dot"></span>
                    <span class="status-text">Êú™Êé•Á∂ö</span>
                </div>
            </div>
        </header>

        <main>
            <!-- „Çø„Çπ„ÇØ‰ΩúÊàê„Éï„Ç©„Éº„É† -->
            <section class="task-form-section">
                <h2>Êñ∞Ë¶è„Çø„Çπ„ÇØ</h2>
                <form id="task-form" method="post" action="javascript:void(0)">
                    <div class="form-group">
                        <label for="instruction">ÂÆüË°åÂÜÖÂÆπ</label>
                        <textarea 
                            id="instruction" 
                            name="instruction" 
                            rows="4" 
                            placeholder="‰æã: „Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÇíË™≠„ÅøÂèñ„Å£„Å¶Ë¶ÅÁ¥Ñ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
                            required
                        ></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="repositories">
                            ‰ΩúÊ•≠„É™„Éù„Ç∏„Éà„É™
                            <span class="required">*</span>
                        </label>
                        <select 
                            id="repositories" 
                            name="repositories"
                            multiple
                            size="5"
                            class="repository-select"
                            required
                        >
                            <!-- „Ç™„Éó„Ç∑„Éß„É≥„ÅØÂãïÁöÑ„Å´ËøΩÂä† -->
                        </select>
                        <small id="repository-help">
                            <span class="info-text">ÈÅ∏Êäû„Åó„Åü„É™„Éù„Ç∏„Éà„É™„Åß„Çø„Çπ„ÇØ„ÅåÂÆüË°å„Åï„Çå„Åæ„Åô</span>
                            <span class="select-hint">ÔºàË§áÊï∞ÈÅ∏Êäû: Ctrl/Cmd„Ç≠„Éº„ÇíÊäº„Åó„Å™„Åå„Çâ„ÇØ„É™„ÉÉ„ÇØÔºâ</span>
                        </small>
                    </div>

                    <!-- SDK„Ç™„Éó„Ç∑„Éß„É≥Ë®≠ÂÆö„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="sdk-options-section">
                        <h3 class="section-title">ÂÆüË°åË®≠ÂÆö</h3>
                        
                        <!-- „Éó„É™„Çª„ÉÉ„ÉàÈÅ∏Êäû -->
                        <div class="form-group preset-selector">
                            <label for="preset-selector">Ë®≠ÂÆö„Éó„É™„Çª„ÉÉ„Éà</label>
                            <div class="preset-controls">
                                <select id="preset-selector" class="preset-select">
                                    <option value="">„Ç´„Çπ„Çø„É†Ë®≠ÂÆö</option>
                                    <option value="loading" disabled>Ë™≠„ÅøËæº„Åø‰∏≠...</option>
                                </select>
                                <button type="button" id="save-preset-btn" class="btn btn-secondary btn-sm" title="ÁèæÂú®„ÅÆË®≠ÂÆö„Çí‰øùÂ≠ò">
                                    üíæ ‰øùÂ≠ò
                                </button>
                                <button type="button" id="delete-preset-btn" class="btn btn-danger btn-sm" title="ÈÅ∏Êäû‰∏≠„ÅÆ„Éó„É™„Çª„ÉÉ„Éà„ÇíÂâäÈô§" style="display: none;">
                                    üóëÔ∏è ÂâäÈô§
                                </button>
                            </div>
                            <small id="preset-description" class="preset-description">
                                „Ç´„Çπ„Çø„É†Ë®≠ÂÆö„Çí‰ΩøÁî®‰∏≠
                            </small>
                        </div>

                        <!-- Âü∫Êú¨Ë®≠ÂÆö -->
                        <div class="basic-settings">
                            <!-- ÊúÄÂ§ß„Çø„Éº„É≥Êï∞ -->
                            <div class="form-group slider-group">
                                <label for="max-turns">
                                    ÊúÄÂ§ß„Çø„Éº„É≥Êï∞
                                    <span class="info-icon" title="Claude„ÅåÂÆüË°å„Åß„Åç„ÇãÊúÄÂ§ß„Çπ„ÉÜ„ÉÉ„ÉóÊï∞">‚ìò</span>
                                    <span class="current-value" id="max-turns-value">50</span>
                                </label>
                                <div class="slider-container">
                                    <input type="range" id="max-turns-slider" 
                                           min="1" max="50" value="50" 
                                           class="slider">
                                    <input type="number" id="max-turns" 
                                           min="1" max="50" value="50" 
                                           class="number-input">
                                </div>
                            </div>

                            <!-- Ê®©Èôê„É¢„Éº„Éâ -->
                            <div class="form-group">
                                <label>
                                    Ê®©Èôê„É¢„Éº„Éâ
                                    <span class="info-icon" title="„ÉÑ„Éº„É´ÂÆüË°åÊôÇ„ÅÆÁ¢∫Ë™çÂãï‰Ωú">‚ìò</span>
                                </label>
                                <div class="toggle-group" role="radiogroup">
                                    <button type="button" class="toggle-btn active" 
                                            data-value="default" data-description="„Åô„Åπ„Å¶„ÅÆÊìç‰ΩúÂâç„Å´Á¢∫Ë™ç">
                                        Á¢∫Ë™ç„ÅÇ„Çä
                                    </button>
                                    <button type="button" class="toggle-btn" 
                                            data-value="acceptEdits" data-description="„Éï„Ç°„Ç§„É´Á∑®ÈõÜ„ÅØËá™Âãï„ÄÅ„Åù„ÅÆ‰ªñ„ÅØÁ¢∫Ë™ç">
                                        Á∑®ÈõÜ„ÅÆ„ÅøËá™Âãï
                                    </button>
                                    <button type="button" class="toggle-btn" 
                                            data-value="bypassPermissions" data-description="„Åô„Åπ„Å¶„ÅÆÊìç‰Ωú„ÇíËá™ÂãïÂÆüË°å">
                                        „Åô„Åπ„Å¶Ëá™Âãï
                                    </button>
                                    <button type="button" class="toggle-btn" 
                                            data-value="plan" data-description="ÂÆüË°å„Åõ„ÅöË®àÁîª„ÅÆ„Åø‰ΩúÊàê">
                                        Ë®àÁîª„ÅÆ„Åø
                                    </button>
                                </div>
                                <small class="permission-description">„Åô„Åπ„Å¶„ÅÆÊìç‰ΩúÂâç„Å´Á¢∫Ë™ç</small>
                            </div>

                            <!-- „Ç∑„Çπ„ÉÜ„É†„Éó„É≠„É≥„Éó„ÉàÔºàÊäò„Çä„Åü„Åü„ÅøÂèØËÉΩÔºâ -->
                            <details class="form-group collapsible-group">
                                <summary class="collapsible-header">
                                    <span class="collapse-icon">‚ñ∂</span>
                                    „Ç∑„Çπ„ÉÜ„É†„Éó„É≠„É≥„Éó„ÉàÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ
                                </summary>
                                <div class="collapsible-content">
                                    <div class="char-count-container">
                                        <span class="char-count" id="system-prompt-count">0 / 10,000</span>
                                    </div>
                                    <textarea id="system-prompt" 
                                              rows="3" 
                                              maxlength="10000"
                                              placeholder="Claude„ÅÆÂãï‰Ωú„ÇíÂà∂Âæ°„Åô„Çã„Éó„É≠„É≥„Éó„ÉàÔºà‰æãÔºöÂ∞ÇÈñÄÁöÑ„Å™ÂõûÁ≠î„ÇíÂøÉ„Åå„Åë„Å¶„Åè„Å†„Åï„ÅÑÔºâ"
                                              class="expanding-textarea"></textarea>
                                </div>
                            </details>
                        </div>

                        <!-- „ÉÑ„Éº„É´Âà∂ÈôêË®≠ÂÆö -->
                        <div class="form-group tool-restrictions">
                            <label>„ÉÑ„Éº„É´Âà∂Èôê</label>
                            <div class="tab-container">
                                <button type="button" class="tab-btn active" data-tab="allowed">
                                    Ë®±ÂèØ„Åô„Çã„ÉÑ„Éº„É´
                                </button>
                                <button type="button" class="tab-btn" data-tab="disallowed">
                                    Á¶ÅÊ≠¢„Åô„Çã„ÉÑ„Éº„É´
                                </button>
                            </div>
                            
                            <div class="tab-content active" id="allowed-tools-tab">
                                <div class="tool-quick-actions">
                                    <button type="button" class="quick-action-btn" data-action="all">„Åô„Åπ„Å¶ÈÅ∏Êäû</button>
                                    <button type="button" class="quick-action-btn" data-action="none">„Åô„Åπ„Å¶Ëß£Èô§</button>
                                    <button type="button" class="quick-action-btn" data-action="safe">ÂÆâÂÖ®„Å™„ÉÑ„Éº„É´„ÅÆ„Åø</button>
                                </div>
                                <div class="checkbox-group tools-grid">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Read" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Read</span>
                                            <span class="tool-desc">„Éï„Ç°„Ç§„É´Ë™≠„ÅøÂèñ„Çä</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Write" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Write</span>
                                            <span class="tool-desc">„Éï„Ç°„Ç§„É´‰ΩúÊàê„ÉªÊõ∏„ÅçËæº„Åø</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Edit" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Edit</span>
                                            <span class="tool-desc">„Éï„Ç°„Ç§„É´Á∑®ÈõÜ</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="MultiEdit" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">MultiEdit</span>
                                            <span class="tool-desc">Ë§áÊï∞Á∑®ÈõÜ</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Bash" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Bash</span>
                                            <span class="tool-desc">„Ç≥„Éû„É≥„ÉâÂÆüË°å</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="LS" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">LS</span>
                                            <span class="tool-desc">„Éá„Ç£„É¨„ÇØ„Éà„É™‰∏ÄË¶ß</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Glob" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Glob</span>
                                            <span class="tool-desc">„Éï„Ç°„Ç§„É´Ê§úÁ¥¢</span>
                                        </span>
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="allowedTools" value="Grep" checked>
                                        <span class="checkbox-text">
                                            <span class="tool-name">Grep</span>
                                            <span class="tool-desc">„ÉÜ„Ç≠„Çπ„ÉàÊ§úÁ¥¢</span>
                                        </span>
                                    </label>
                                </div>
                                <div class="custom-tools-group">
                                    <label for="custom-allowed-tools">„Ç´„Çπ„Çø„É†„ÉÑ„Éº„É´Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ</label>
                                    <input 
                                        type="text" 
                                        id="custom-allowed-tools" 
                                        name="customAllowedTools"
                                        placeholder="‰æã: Bash(npm:*), mcp__filesystem__read_file"
                                    >
                                </div>
                            </div>
                            
                            <div class="tab-content" id="disallowed-tools-tab">
                                <div class="checkbox-group tools-grid">
                                    <!-- ÂêåÊßò„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„É™„Çπ„ÉàÔºàname="disallowedTools"Ôºâ -->
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="disallowedTools" value="Bash">
                                        <span class="checkbox-text">
                                            <span class="tool-name">Bash</span>
                                            <span class="tool-desc">„Ç≥„Éû„É≥„ÉâÂÆüË°å</span>
                                        </span>
                                    </label>
                                    <!-- ‰ªñ„ÅÆ„ÉÑ„Éº„É´„ÇÇÂêåÊßò„Å´ -->
                                </div>
                                <div class="custom-tools-group">
                                    <label for="custom-disallowed-tools">„Ç´„Çπ„Çø„É†„ÉÑ„Éº„É´Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ</label>
                                    <input 
                                        type="text" 
                                        id="custom-disallowed-tools" 
                                        name="customDisallowedTools"
                                        placeholder="‰æã: Bash(rm:*), Bash(sudo:*)"
                                    >
                                </div>
                            </div>
                        </div>

                        <!-- È´òÂ∫¶„Å™Ë®≠ÂÆöÔºàÊäò„Çä„Åü„Åü„ÅøÔºâ -->
                        <details class="advanced-settings">
                            <summary class="advanced-toggle">
                                <span class="collapse-icon">‚ñ∂</span>
                                È´òÂ∫¶„Å™Ë®≠ÂÆö
                            </summary>
                            
                            <div class="advanced-content">
                                <!-- „Çø„Ç§„É†„Ç¢„Ç¶„ÉàË®≠ÂÆö -->
                                <div class="form-group">
                                    <label for="timeout">
                                        „Çø„Ç§„É†„Ç¢„Ç¶„ÉàÔºàÁßíÔºâ
                                        <span class="info-icon" title="„Çø„Çπ„ÇØ„ÅÆÊúÄÂ§ßÂÆüË°åÊôÇÈñì">‚ìò</span>
                                    </label>
                                    <input 
                                        type="number" 
                                        id="timeout" 
                                        name="timeout"
                                        value="600"
                                        min="1"
                                        max="3600"
                                        class="number-input"
                                    >
                                </div>

                                <!-- Âá∫ÂäõÂΩ¢Âºè -->
                                <div class="form-group">
                                    <label>Âá∫ÂäõÂΩ¢Âºè</label>
                                    <div class="radio-group">
                                        <label class="radio-label">
                                            <input type="radio" name="outputFormat" value="text" checked>
                                            <span>„ÉÜ„Ç≠„Çπ„Éà</span>
                                        </label>
                                        <label class="radio-label">
                                            <input type="radio" name="outputFormat" value="json">
                                            <span>JSON</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <!-- ÂÆüË°åÁí∞Â¢É -->
                                <div class="form-group">
                                    <label for="executable">ÂÆüË°åÁí∞Â¢É</label>
                                    <select id="executable" class="select-input">
                                        <option value="node">Node.js</option>
                                        <option value="python">Python</option>
                                        <option value="bash">Bash</option>
                                    </select>
                                </div>
                                
                                <!-- MCPË®≠ÂÆö -->
                                <div class="form-group">
                                    <label for="mcp-config">
                                        MCPË®≠ÂÆöÔºàJSONÔºâ
                                        <span class="info-icon" title="Model Context ProtocolË®≠ÂÆö">‚ìò</span>
                                    </label>
                                    <textarea id="mcp-config" 
                                              rows="4" 
                                              class="code-input"
                                              placeholder='{"server-name": {"command": "path/to/server"}}'></textarea>
                                    <div class="validation-message error" id="mcp-validation"></div>
                                </div>
                                
                                <!-- „Çª„ÉÉ„Ç∑„Éß„É≥ÁÆ°ÁêÜ -->
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="continue-session">
                                        <span>ÂâçÂõû„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥„ÇíÁ∂ôÁ∂ö</span>
                                    </label>
                                </div>
                                
                                <!-- Ë©≥Á¥∞„É≠„Ç∞ -->
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="verbose">
                                        <span>Ë©≥Á¥∞„É≠„Ç∞„ÇíË°®Á§∫</span>
                                    </label>
                                </div>
                                
                                <!-- WebÊ§úÁ¥¢ -->
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="enable-web-search">
                                        <span>WebÊ§úÁ¥¢„ÇíÊúâÂäπÂåñ</span>
                                    </label>
                                </div>
                            </div>
                        </details>

                        <!-- Git Worktree„Ç™„Éó„Ç∑„Éß„É≥ -->
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="use-worktree" name="useWorktree">
                                <span>Git Worktree„Çí‰ΩøÁî®ÔºàÁã¨Á´ã„Åó„Åü‰ΩúÊ•≠„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅßÂÆüË°åÔºâ</span>
                            </label>
                            <div id="worktree-options" class="worktree-options" style="display: none;">
                                <div class="form-group">
                                    <label for="worktree-branch">„Éñ„É©„É≥„ÉÅÂêçÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ</label>
                                    <input 
                                        type="text" 
                                        id="worktree-branch" 
                                        name="worktreeBranch"
                                        placeholder="‰æã: feature/task-123"
                                        class="text-input"
                                    >
                                    <small>ÊåáÂÆö„Åó„Å™„ÅÑÂ†¥Âêà„ÅØËá™ÂãïÁîüÊàê„Åï„Çå„Åæ„Åô</small>
                                </div>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="keepWorktree">
                                    <span>„Çø„Çπ„ÇØÂÆå‰∫ÜÂæå„ÇÇWorktree„Çí‰øùÊåÅ</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-large">„Çø„Çπ„ÇØ„ÇíÂÆüË°å</button>
                </form>
            </section>

            <!-- „Çø„Çπ„ÇØ‰∏ÄË¶ß -->
            <section class="task-list-section">
                <h2>„Çø„Çπ„ÇØ‰∏ÄË¶ß</h2>
                <div class="task-filters">
                    <select id="status-filter" class="select-input">
                        <option value="">„Åô„Åπ„Å¶</option>
                        <option value="pending">ÂæÖÊ©ü‰∏≠</option>
                        <option value="running">ÂÆüË°å‰∏≠</option>
                        <option value="completed">ÂÆå‰∫Ü</option>
                        <option value="failed">Â§±Êïó</option>
                        <option value="cancelled">„Ç≠„É£„É≥„Çª„É´</option>
                    </select>
                </div>
                
                <!-- ‰∏äÈÉ®„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
                <div id="pagination-top"></div>
                
                <div id="task-list" class="task-list">
                    <!-- „Çø„Çπ„ÇØ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </div>
                
                <!-- ‰∏ãÈÉ®„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
                <div id="pagination-bottom"></div>
            </section>
        </main>

        <!-- „Çø„Çπ„ÇØË©≥Á¥∞„É¢„Éº„ÉÄ„É´ -->
        <div id="task-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>„Çø„Çπ„ÇØË©≥Á¥∞</h2>
                <div id="task-detail">
                    <!-- „Çø„Çπ„ÇØË©≥Á¥∞„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </div>
                <div id="task-todos" class="task-todos hidden">
                    <!-- TODO„É™„Çπ„Éà„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </div>
                <div id="task-statistics" class="task-statistics hidden">
                    <!-- Áµ±Ë®àÊÉÖÂ†±„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </div>
                <div class="task-logs">
                    <div class="log-header">
                        <h3>ÂÆüË°å„É≠„Ç∞</h3>
                    </div>
                    <div id="task-logs" class="streaming-log">
                        <!-- „Çπ„Éà„É™„Éº„Éü„É≥„Ç∞„É≠„Ç∞„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                    </div>
                </div>
            </div>
        </div>

        <!-- „Éó„É™„Çª„ÉÉ„Éà‰øùÂ≠ò„É¢„Éº„ÉÄ„É´ -->
        <div id="save-preset-modal" class="modal hidden">
            <div class="modal-content modal-small">
                <span class="close">&times;</span>
                <h2>„Éó„É™„Çª„ÉÉ„Éà„Çí‰øùÂ≠ò</h2>
                <form id="save-preset-form">
                    <div class="form-group">
                        <label for="preset-name">„Éó„É™„Çª„ÉÉ„ÉàÂêç</label>
                        <input type="text" id="preset-name" required placeholder="‰æã: ÈñãÁô∫Áî®Ë®≠ÂÆö">
                    </div>
                    <div class="form-group">
                        <label for="preset-description">Ë™¨ÊòéÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ</label>
                        <textarea id="preset-description" rows="3" placeholder="„Åì„ÅÆ„Éó„É™„Çª„ÉÉ„Éà„ÅÆÁî®ÈÄî„ÇíÂÖ•Âäõ"></textarea>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancel-save-preset">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn btn-primary">‰øùÂ≠ò</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- „Éó„É™„Çª„ÉÉ„ÉàÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
        <div id="manage-presets-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>„Éó„É™„Çª„ÉÉ„ÉàÁÆ°ÁêÜ</h2>
                <div class="preset-list" id="preset-list">
                    <!-- „Éó„É™„Çª„ÉÉ„Éà‰∏ÄË¶ß„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                </div>
            </div>
        </div>
    </div>

    <script src="api.js"></script>
    <script src="utils.js"></script>
    <script src="app-common.js"></script>
    <script src="app.js"></script>
</body>
</html>