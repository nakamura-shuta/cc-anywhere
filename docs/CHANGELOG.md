# CC-Anywhere 変更履歴

## [未リリース]

### 追加
- フロントエンドアーキテクチャの全面的な改善
  - モジュラーなJavaScriptアーキテクチャを実装
    - `logger.js` - 構造化されたフロントエンドロギングシステム
    - `websocket-manager.js` - 中央集権的なWebSocket接続管理（自動再接続、イベント駆動）
    - `state-manager.js` - グローバル状態管理システム
    - `error-handler.js` - 統一されたエラーハンドリング機構
  - CSSのモジュール化と整理
    - 重複定義を削除し、5つのモジュールに分割（base、components、layouts、page固有）
    - レスポンシブデザインの改善
  - WebSocketイベントの拡充
    - `task:tool:start` / `task:tool:end` - ツール実行の詳細追跡
    - `task:claude:response` - Claude応答のリアルタイム表示
    - `task:statistics` - タスク統計情報の更新
    - `todo:update` - TODO進捗の追跡

### 追加
- Web検索機能をClaude Code SDKオプションに追加
  - `enableWebSearch`オプションでWeb検索機能の有効化/無効化が可能
  - Web UIに「Web検索を有効化」チェックボックスを追加
  - 最新情報や時事的な質問に対してWeb検索を使用した回答が可能に
- セッション管理機能を追加（複数ターンの会話をサポート）
  - セッションの作成・管理・削除APIを実装
  - 会話履歴の保存と取得機能
  - 注意：Claude Code SDKのresumeSessionオプションにバグがあるため、現時点では完全に動作しません
  - 関連issue: https://github.com/anthropics/claude-code/issues/1967
- インタラクティブな確認処理（WebSocket双方向通信）機能をTODO.mdに追加
  - Claude Code SDKの確認プロンプトに対する応答機能の実装計画
  - リアルタイムでの承認/拒否の送信機能
- スケジューラー機能を実装
  - Cron式による定期実行
  - ワンタイム実行（指定日時での1回限り実行）
  - Web UIからのスケジュール管理
  - 実行履歴の追跡
  - APIエンドポイント一式（作成、一覧、更新、削除、有効化/無効化）
- タスク一覧のページネーション機能を実装
  - Web UIに上部・下部のページネーションコントロールを追加
  - 表示件数選択機能（10, 20, 50, 100件）
  - ページ番号による直接移動
  - フィルタ変更時の自動ページリセット
  - レスポンシブ対応のページネーションUI

### 変更
- 権限モードUIの統一とわかりやすさの改善
  - タスク実行画面とスケジューラー画面で権限モードの表記を統一
  - 技術的な用語から日本語のわかりやすい表現に変更
    - 確認あり（旧: default）
    - 編集のみ自動（旧: acceptEdits）
    - すべて自動（旧: bypassPermissions）
    - 計画のみ（旧: plan）
  - スケジュール一覧に権限モード表示を追加
- タスク一覧の更新ボタンを削除（5秒ごとの自動更新で十分なため）
- タスク一覧に表示する実行内容を60文字から40文字に短縮
- タスクがない場合の表示を改善
- ドキュメントおよびコード内の個人環境パスを汎用的なパスに変更

### 修正
- タスク詳細モーダルのキャッシュ問題を修正
  - 前回開いたタスクの情報が残る問題を解決
  - タスクID検証とクリーンアップ処理を強化
  - WebSocketサブスクリプション管理を改善
- タスク統計の0%成功率表示を修正
  - ツールを使用しなかった場合は"N/A"を表示するように変更
- スケジューラーWeb UIの無効化/有効化ボタンのエラーを修正（Content-Typeヘッダーの送信条件を修正）
- ページ変更時のレイアウト崩れを修正
- TypeScriptの型警告を修正
- スケジューラーとタスク実行画面のスタイル統一性を改善
  - ヘッダー構造の統一

### 削除
- 不要な`task-detail-streaming.html`ファイルを削除（メインUIに統合済み）
- 重複したCSSファイルを削除（`common.css`、`style.css`、`style-advanced.css`）
  - 接続状態表示の追加
  - CSS変数による色の一貫性確保
- スケジューラーの作業リポジトリ選択が機能しない問題を修正
  - APIキーのデフォルト値設定
  - APIクライアントメソッドの統一使用
  - repositories配列の適切な送信
- スケジューラー画面のレイアウトを改善
  - タスク実行画面と同じ2カラムレイアウトに統一
  - スタイルをタスク実行画面と完全に統一（ボタン、カード、フィルター等）
  - 不要な「スケジューラー」タイトルを削除
  - レスポンシブ対応（768px以下で1カラム表示）

### 削除
- 不要な古いファイルを削除
  - web/index-simple.html（統合前の古いバージョン）
  - web/app-simple.js（統合前の古いバージョン）

## [0.1.0] - 2024-12-01

### 初回リリース
- 基本的なタスク実行機能
- Claude Code SDK統合
- Web UI実装
- APIエンドポイント実装