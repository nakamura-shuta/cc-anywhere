import"../chunks/NZTpNUN0.js";import{p as Re,m as Ae,k as I,l as C,f as i,h as u,C as d,B as g,a as t,s as a,e as fe,g as e,c as n,r as s,t as J,d as ne,b as ze}from"../chunks/BC3TVD7I.js";import{o as We,s as N}from"../chunks/l49-8nyp.js";import{e as De,i as Me}from"../chunks/DsjvRSSA.js";import{c as F}from"../chunks/02-ts27b.js";import{e as Xe}from"../chunks/Df5QlUi0.js";import{g as we}from"../chunks/BcvC9Oiq.js";import{B as Se}from"../chunks/D0eVI3ve.js";import{c as Je,C as Ne,a as Ge,b as He,B as Be}from"../chunks/D8w9bG22.js";import{C as Ke}from"../chunks/CBkskisn.js";import{C as Ee,a as Ye,I as qe}from"../chunks/BQ90MmJD.js";import{L as ie,T as Ze}from"../chunks/r9BZVVQU.js";import{R as et,S as tt,a as rt,b as at}from"../chunks/DsBsWcym.js";import{t as st}from"../chunks/8rlv28yI.js";import{p as je,i as le}from"../chunks/DlBJ8HRE.js";import{s as ot}from"../chunks/CBF8HN5J.js";import{r as lt,S as Fe,A as Ie,a as Le,C as Oe,b as nt}from"../chunks/C1wJuPHU.js";import{F as it,C as dt}from"../chunks/B_QOyeby.js";import{A as vt}from"../chunks/BEoimOpo.js";const ct=!1,ut=async()=>({}),Zt=Object.freeze(Object.defineProperty({__proto__:null,load:ut,prerender:ct},Symbol.toStringTag,{value:"Module"}));var _t=i("<!> <!>",1),ft=i('<div class="flex items-center space-x-2"><!> <!></div>'),pt=i('<div class="space-y-2"></div>'),mt=i("<!> <!>",1),$t=i("<!> <!>",1),gt=i('<!> <span class="font-medium"> </span>',1),ht=i("<!> 選択中",1),xt=i("<!> 利用不可",1),bt=i('<div><!> <div class="flex-1 min-w-0"><!> <p class="text-xs text-muted-foreground truncate mt-1"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div>'),yt=i('<div class="pt-4 border-t"><p class="text-sm text-muted-foreground">選択された作業ディレクトリ: <span class="font-medium text-foreground"> </span></p></div>'),Pt=i('<div class="space-y-4"><div class="flex items-center space-x-2 pb-2 border-b"><!> <!></div> <div class="space-y-2"></div> <!></div>'),kt=i("<!> <!>",1);function Ct(ye,de){Re(de,!0);let o=je(de,"selectedDirectories",31,()=>Ae([])),L=je(de,"onSelectionChange",3,()=>{}),b=I(Ae([])),G=I(!0),ve=I(null),w=ne(()=>e(b).length>0&&e(b).every(v=>o().includes(v.path))),pe=ne(()=>o().length>0&&o().length<e(b).length);We(async()=>{try{C(b,await lt.list(),!0),C(G,!1)}catch(v){C(ve,v instanceof Error?v.message:"作業ディレクトリの取得に失敗しました",!0),C(G,!1)}});function me(v){o().includes(v)?o(o().filter(ee=>ee!==v)):o([...o(),v]),L()(o())}function H(){e(w)?o([]):o(e(b).map(v=>v.path)),L()(o())}function Pe(v){return!0}Je(ye,{children:(v,ee)=>{var $e=kt(),ge=u($e);Ne(ge,{children:(E,q)=>{var O=_t(),K=u(O);Ge(K,{children:(Q,y)=>{d();var f=g("作業ディレクトリ選択");t(Q,f)},$$slots:{default:!0}});var te=a(K,2);Ke(te,{children:(Q,y)=>{d();var f=g("タスクを実行する作業ディレクトリを選択してください");t(Q,f)},$$slots:{default:!0}}),t(E,O)},$$slots:{default:!0}});var B=a(ge,2);He(B,{children:(E,q)=>{var O=fe(),K=u(O);{var te=y=>{var f=pt();De(f,20,()=>Array(3),Me,(U,he)=>{var h=ft(),_=n(h);Fe(_,{class:"h-4 w-4"});var S=a(_,2);Fe(S,{class:"h-4 flex-1"}),s(h),t(U,h)}),s(f),t(y,f)},Q=y=>{var f=fe(),U=u(f);{var he=_=>{Ie(_,{variant:"destructive",children:(S,R)=>{var A=mt(),P=u(A);Ee(P,{class:"h-4 w-4"});var p=a(P,2);Le(p,{children:(m,V)=>{d();var D=g();J(()=>N(D,e(ve))),t(m,D)},$$slots:{default:!0}}),t(S,A)},$$slots:{default:!0}})},h=_=>{var S=fe(),R=u(S);{var A=p=>{Ie(p,{children:(m,V)=>{var D=$t(),W=u(D);Ee(W,{class:"h-4 w-4"});var X=a(W,2);Le(X,{children:(Y,ce)=>{d();var M=g("作業ディレクトリが設定されていません。backend/config/repositories.jsonを確認してください。");t(Y,M)},$$slots:{default:!0}}),t(m,D)},$$slots:{default:!0}})},P=p=>{var m=Pt(),V=n(m),D=n(V);Oe(D,{get checked(){return e(w)},get indeterminate(){return e(pe)},onCheckedChange:H});var W=a(D,2);ie(W,{class:"text-sm font-medium cursor-pointer",onclick:H,children:(M,$)=>{d();var x=g();J(()=>N(x,`すべて選択 (${o().length??""}/${e(b).length??""})`)),t(M,x)},$$slots:{default:!0}}),s(V);var X=a(V,2);De(X,21,()=>e(b),Me,(M,$)=>{var x=bt();const z=ne(()=>o().includes(e($).path)),r=ne(()=>Pe(e($)));var T=n(x);{let c=ne(()=>!e(r));Oe(T,{get checked(){return e(z)},get disabled(){return e(c)},onCheckedChange:()=>me(e($).path)})}var l=a(T,2),re=n(l);ie(re,{class:"flex items-center gap-2 cursor-pointer",onclick:()=>e(r)&&me(e($).path),children:(c,se)=>{var oe=gt(),k=u(oe);it(k,{class:"h-4 w-4 text-muted-foreground flex-shrink-0"});var j=a(k,2),Ce=n(j,!0);s(j),J(()=>N(Ce,e($).name)),t(c,oe)},$$slots:{default:!0}});var Z=a(re,2),xe=n(Z,!0);s(Z),s(l);var be=a(l,2),ae=n(be);{var ue=c=>{Be(c,{variant:"secondary",class:"text-xs",children:(se,oe)=>{var k=ht(),j=u(k);Ye(j,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(ae,c=>{e(z)&&c(ue)})}var _e=a(ae,2);{var ke=c=>{Be(c,{variant:"destructive",class:"text-xs",children:(se,oe)=>{var k=xt(),j=u(k);dt(j,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(_e,c=>{e(r)||c(ke)})}s(be),s(x),J(()=>{ot(x,1,`flex items-center space-x-3 p-3 rounded-lg border transition-colors ${e(z)?"bg-muted/50 border-primary/20":"hover:bg-muted/30"}`),N(xe,e($).path)}),t(M,x)}),s(X);var Y=a(X,2);{var ce=M=>{var $=yt(),x=n($),z=a(n(x)),r=n(z);s(z),s(x),s($),J(()=>N(r,`${o().length??""}個`)),t(M,$)};le(Y,M=>{o().length>0&&M(ce)})}s(m),t(p,m)};le(R,p=>{e(b).length===0?p(A):p(P,!1)},!0)}t(_,S)};le(U,_=>{e(ve)?_(he):_(h,!1)},!0)}t(y,f)};le(K,y=>{e(G)?y(te):y(Q,!1)})}t(E,O)},$$slots:{default:!0}}),t(v,$e)},$$slots:{default:!0}}),ze()}var wt=i("<!> タスク一覧に戻る",1),St=i("<!> <!>",1),At=i("<!> <!>",1),Dt=i("<!> ",1),Mt=i('<form class="space-y-6"><div class="space-y-2"><!> <!></div> <!> <div class="grid grid-cols-2 gap-4"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div></div> <div class="space-y-2"><!> <!></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Tt=i("<!> <!>",1),Bt=i('<div class="container mx-auto p-6 max-w-2xl"><div class="mb-6"><!> <h1 class="text-3xl font-bold">新規タスク作成</h1></div> <!></div>');function er(ye,de){Re(de,!0);let o=I(""),L=I(Ae([])),b=I(30),G=I(3e5),ve=!0,w=I("allow");const pe=[{value:"ask",label:"確認する (ask)"},{value:"allow",label:"すべて許可 (allow)"},{value:"deny",label:"すべて拒否 (deny)"},{value:"bypassPermissions",label:"権限バイパス (bypassPermissions)"},{value:"acceptEdits",label:"編集を受け入れる (acceptEdits)"},{value:"plan",label:"計画モード (plan)"}],me=ne(()=>pe.find(B=>B.value===e(w))?.label??"権限モードを選択");let H=I(!1);async function Pe(B){if(B.preventDefault(),!e(o).trim()){alert("指示内容を入力してください");return}if(e(L).length===0){alert("作業ディレクトリを選択してください");return}C(H,!0);const E={instruction:e(o).trim(),context:{workingDirectory:e(L)[0],files:[]},options:{timeout:e(G),async:ve,sdk:{maxTurns:e(b),permissionMode:Array.isArray(e(w))?e(w)[0]:e(w)}}};console.log("Creating task with request:",JSON.stringify(E,null,2)),console.log("Permission mode type:",typeof e(w),"value:",e(w));try{(await st.createTask(E)).data&&we("/tasks")}catch(q){console.error("Failed to create task:",q),alert("タスクの作成に失敗しました")}finally{C(H,!1)}}var v=Bt(),ee=n(v),$e=n(ee);Se($e,{variant:"ghost",onclick:()=>we("/tasks"),class:"gap-2 mb-4",children:(B,E)=>{var q=wt(),O=u(q);vt(O,{class:"h-4 w-4"}),d(),t(B,q)},$$slots:{default:!0}}),d(2),s(ee);var ge=a(ee,2);F(ge,()=>Je,(B,E)=>{E(B,{children:(q,O)=>{var K=Tt(),te=u(K);F(te,()=>Ne,(y,f)=>{f(y,{children:(U,he)=>{var h=St(),_=u(h);F(_,()=>Ge,(R,A)=>{A(R,{children:(P,p)=>{d();var m=g("タスク設定");t(P,m)},$$slots:{default:!0}})});var S=a(_,2);F(S,()=>Ke,(R,A)=>{A(R,{children:(P,p)=>{d();var m=g("実行したいタスクの内容を入力してください");t(P,m)},$$slots:{default:!0}})}),t(U,h)},$$slots:{default:!0}})});var Q=a(te,2);F(Q,()=>He,(y,f)=>{f(y,{children:(U,he)=>{var h=Mt(),_=n(h),S=n(_);ie(S,{for:"instruction",class:"required",children:(r,T)=>{d();var l=g("指示内容");t(r,l)},$$slots:{default:!0}});var R=a(S,2);Ze(R,{id:"instruction",placeholder:"例: README.mdファイルを作成してください",rows:4,required:!0,class:"resize-none",get value(){return e(o)},set value(r){C(o,r,!0)}}),s(_);var A=a(_,2);Ct(A,{onSelectionChange:r=>{C(L,r,!0)},get selectedDirectories(){return e(L)},set selectedDirectories(r){C(L,r,!0)}});var P=a(A,2),p=n(P),m=n(p);ie(m,{for:"maxTurns",children:(r,T)=>{d();var l=g("最大ターン数");t(r,l)},$$slots:{default:!0}});var V=a(m,2);qe(V,{id:"maxTurns",type:"number",min:1,max:100,get value(){return e(b)},set value(r){C(b,r,!0)}}),s(p);var D=a(p,2),W=n(D);ie(W,{for:"timeout",children:(r,T)=>{d();var l=g("タイムアウト (ms)");t(r,l)},$$slots:{default:!0}});var X=a(W,2);qe(X,{id:"timeout",type:"number",min:1e3,step:1e3,get value(){return e(G)},set value(r){C(G,r,!0)}}),s(D),s(P);var Y=a(P,2),ce=n(Y);ie(ce,{for:"permissionMode",children:(r,T)=>{d();var l=g("権限モード");t(r,l)},$$slots:{default:!0}});var M=a(ce,2);F(M,()=>et,(r,T)=>{T(r,{type:"single",get value(){return e(w)},set value(l){C(w,l,!0)},children:(l,re)=>{var Z=At(),xe=u(Z);F(xe,()=>tt,(ae,ue)=>{ue(ae,{id:"permissionMode",children:(_e,ke)=>{d();var c=g();J(()=>N(c,e(me))),t(_e,c)},$$slots:{default:!0}})});var be=a(xe,2);F(be,()=>rt,(ae,ue)=>{ue(ae,{children:(_e,ke)=>{var c=fe(),se=u(c);De(se,17,()=>pe,Me,(oe,k)=>{var j=fe(),Ce=u(j);F(Ce,()=>at,(Qe,Ue)=>{Ue(Qe,{get value(){return e(k).value},get label(){return e(k).label},children:(Ve,Et)=>{d();var Te=g();J(()=>N(Te,e(k).label)),t(Ve,Te)},$$slots:{default:!0}})}),t(oe,j)}),t(_e,c)},$$slots:{default:!0}})}),t(l,Z)},$$slots:{default:!0}})}),s(Y);var $=a(Y,2),x=n($);Se(x,{type:"submit",get disabled(){return e(H)},class:"gap-2",children:(r,T)=>{var l=Dt(),re=u(l);nt(re,{class:"h-4 w-4"});var Z=a(re);J(()=>N(Z,` ${e(H)?"作成中...":"タスクを作成"}`)),t(r,l)},$$slots:{default:!0}});var z=a(x,2);Se(z,{type:"button",variant:"outline",onclick:()=>we("/tasks"),children:(r,T)=>{d();var l=g("キャンセル");t(r,l)},$$slots:{default:!0}}),s($),s(h),Xe("submit",h,Pe),t(U,h)},$$slots:{default:!0}})}),t(q,K)},$$slots:{default:!0}})}),s(v),t(ye,v),ze()}export{er as component,Zt as universal};
