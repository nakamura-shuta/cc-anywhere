import{t as zt}from"../chunks/8-ECe_Y2.js";import{e as ke}from"../chunks/DNSHY1Ls.js";import"../chunks/NZTpNUN0.js";import{d as V,e as m,a as t,h as $t,g as o,l as At,aq as be,p as Vt,b as Gt,f as d,c as s,n as ye,r as e,t as j,k as Bt,m as oe,u as qt,s as r,C as B,B as et}from"../chunks/CibTsHxy.js";import{a as le,s as h}from"../chunks/DMzQSiFV.js";import{l as Jt,s as Ht,p as ht,i as L,r as ue,b as Pe}from"../chunks/D2tfWl3j.js";import{I as Wt,s as Xt,a as Pt,i as Tt}from"../chunks/BBRwJ9cY.js";import{c as O}from"../chunks/Dmq7Nx9n.js";import{a as Te,e as Ce,f as Se,s as De}from"../chunks/BR09V1wi.js";import{d as je}from"../chunks/BTv9tsTU.js";import"../chunks/bHnqJfhe.js";import{c as Oe,B as Ct}from"../chunks/BkNxBhzy.js";import{B as gt,C as St,a as Dt}from"../chunks/Bvs5g0ah.js";import{C as Ae}from"../chunks/DP_CO7Qi.js";import{C as de}from"../chunks/0oRBVGTn.js";import{C as jt,a as Ot}from"../chunks/CeXjzowc.js";import{t as ne}from"../chunks/BtUCVySZ.js";import{u as Ne}from"../chunks/Cdn4UCvV.js";import{a as Ie,c as Re,b as Ue,d as Ft,m as Fe}from"../chunks/CvxMnhAS.js";import{T as Be,a as Le,b as Lt,c as Mt}from"../chunks/Du8LWhr8.js";import{A as Me}from"../chunks/sbTcS15C.js";import{R as ie}from"../chunks/CVkBE2Ak.js";import{F as Et,C as ze}from"../chunks/DpKdUl5G.js";import{D as He}from"../chunks/CtjtpxG-.js";import"../chunks/B5zMa-mz.js";import{C as ve}from"../chunks/th8Y5GeV.js";import{f as qe,j as Ee}from"../chunks/C74-udT0.js";import{G as Ve}from"../chunks/BPKQsP3q.js";import{C as Ge}from"../chunks/BST5KIEH.js";function Je(z,a){const i=Jt(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const A=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"}]];Wt(z,Ht({name:"activity"},()=>i,{get iconNode(){return A},children:(H,K)=>{var Z=V(),at=m(Z);Xt(at,a,"default",{}),t(H,Z)},$$slots:{default:!0}}))}function ce(z,a){const i=Jt(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const A=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}]];Wt(z,Ht({name:"message-square"},()=>i,{get iconNode(){return A},children:(H,K)=>{var Z=V(),at=m(Z);Xt(at,a,"default",{}),t(H,Z)},$$slots:{default:!0}}))}function We(z,a){const i=Jt(a,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const A=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344"}],["path",{d:"m9 11 3 3L22 4"}]];Wt(z,Ht({name:"square-check-big"},()=>i,{get iconNode(){return A},children:(H,K)=>{var Z=V(),at=m(Z);Xt(at,a,"default",{}),t(H,Z)},$$slots:{default:!0}}))}const Xe=Re({component:"progress",parts:["root"]});class Kt{static create(a){return new Kt(a)}opts;attachment;constructor(a){this.opts=a,this.attachment=Ie(this.opts.ref)}#t=$t(()=>({role:"progressbar",value:this.opts.value.current,"aria-valuemin":this.opts.min.current,"aria-valuemax":this.opts.max.current,"aria-valuenow":this.opts.value.current===null?void 0:this.opts.value.current,"data-value":this.opts.value.current===null?void 0:this.opts.value.current,"data-state":Ke(this.opts.value.current,this.opts.max.current),"data-max":this.opts.max.current,"data-min":this.opts.min.current,"data-indeterminate":this.opts.value.current===null?"":void 0,[Xe.root]:"",...this.attachment}));get props(){return o(this.#t)}set props(a){At(this.#t,a)}}function Ke(z,a){return z===null?"indeterminate":z===a?"loaded":"loading"}var Qe=d("<div><!></div>");function Ye(z,a){const i=be();Vt(a,!0);let A=ht(a,"value",3,0),H=ht(a,"max",3,100),K=ht(a,"min",3,0),Z=ht(a,"id",19,()=>Ue(i)),at=ht(a,"ref",15,null),lt=ue(a,["$$slots","$$events","$$legacy","child","children","value","max","min","id","ref"]);const Nt=Kt.create({value:Ft.with(()=>A()),max:Ft.with(()=>H()),min:Ft.with(()=>K()),id:Ft.with(()=>Z()),ref:Ft.with(()=>at(),dt=>at(dt))}),it=$t(()=>Fe(lt,Nt.props));var It=V(),wt=m(It);{var Rt=dt=>{var vt=V(),kt=m(vt);le(kt,()=>a.child,()=>({props:o(it)})),t(dt,vt)},Ut=dt=>{var vt=Qe();Te(vt,()=>({...o(it)}));var kt=s(vt);le(kt,()=>a.children??ye),e(vt),t(dt,vt)};L(wt,dt=>{a.child?dt(Rt):dt(Ut,!1)})}t(z,It),Gt()}const Ze=!1,ta=async({params:z})=>{try{const a=await zt.get(z.id),i=await zt.getLogs(z.id);let A=[];try{A=(await zt.list({limit:100})).data.filter(K=>K.continuedFrom===z.id||K.parentTaskId===z.id)}catch(H){console.error("Failed to load child tasks:",H)}return{task:a,logs:i.logs,childTasks:A}}catch(a){console.error("Failed to load task:",a),ke(404,"タスクが見つかりません")}},jr=Object.freeze(Object.defineProperty({__proto__:null,load:ta,prerender:Ze},Symbol.toStringTag,{value:"Module"}));var ea=d('<div data-slot="progress-indicator" class="bg-primary h-full w-full flex-1 transition-all"></div>');function aa(z,a){Vt(a,!0);let i=ht(a,"ref",15,null),A=ht(a,"max",3,100),H=ue(a,["$$slots","$$events","$$legacy","ref","class","max","value"]);var K=V(),Z=m(K);{let at=$t(()=>Oe("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a.class));O(Z,()=>Ye,(lt,Nt)=>{Nt(lt,Ht({"data-slot":"progress",get class(){return o(at)},get value(){return a.value},get max(){return A()}},()=>H,{get ref(){return i()},set ref(it){i(it)},children:(it,It)=>{var wt=ea();j(()=>Ce(wt,`transform: translateX(-${100-100*(a.value??0)/(A()??1)}%)`)),t(it,wt)},$$slots:{default:!0}}))})}t(z,K),Gt()}var ra=d("<!> タスク一覧に戻る",1),sa=d('<div class="flex items-center gap-2 text-sm text-muted-foreground"><div class="h-2 w-2 bg-green-500 rounded-full animate-pulse"></div> リアルタイム更新中</div>'),oa=d("<!> 更新",1),la=d('<div class="flex items-center justify-between"><!> <!></div>'),da=d("<!> ",1),na=d('<div><p class="text-sm text-muted-foreground">親タスク</p> <!></div>'),ia=d('<div><p class="text-sm text-muted-foreground">作業ディレクトリ</p> <div class="flex items-center gap-2"><!> <p class="font-mono text-sm text-gray-700 dark:text-gray-300"> </p></div></div>'),va=d("<!> ",1),ca=d('<div><p class="text-sm text-muted-foreground">対象リポジトリ</p> <div class="flex flex-wrap gap-2 mt-1"></div></div>'),ua=d('<div><p class="text-sm text-muted-foreground">完了日時</p> <p class="text-sm"> </p></div>'),_a=d('<div><p class="text-sm text-muted-foreground">エラー</p> <p class="text-destructive whitespace-pre-wrap break-words"> </p></div>'),fa=d('<div><p class="text-sm text-muted-foreground">ID</p> <p class="font-mono"> </p></div> <!> <div><p class="text-sm text-muted-foreground mb-2">指示内容</p> <div class="bg-muted/50 rounded-lg p-4 max-h-64 overflow-y-auto"><p class="whitespace-pre-wrap break-words text-sm"> </p></div></div> <!> <!> <div class="grid grid-cols-2 gap-4"><div><p class="text-sm text-muted-foreground">作成日時</p> <p class="text-sm"> </p></div> <div><p class="text-sm text-muted-foreground">更新日時</p> <p class="text-sm"> </p></div></div> <!> <!>',1),ma=d("<!> タスクをキャンセル",1),pa=d("<!> 継続タスクを作成",1),ga=d("<!> <!> <!> <!>",1),xa=d('<div class="flex items-center gap-2 text-sm text-muted-foreground"><!> <span> </span></div>'),ha=d('<div class="space-y-4"><div class="space-y-2"><div class="flex justify-between text-sm"><span> </span> <span> </span></div> <!></div> <!></div>'),$a=d("<!> <!>",1),wa=d('<div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="text-center"><p class="text-2xl font-bold"> </p> <p class="text-sm text-muted-foreground">ツール使用回数</p></div> <div class="text-center"><p class="text-2xl font-bold"> </p> <p class="text-sm text-muted-foreground">変更ファイル数</p></div> <div class="text-center"><p class="text-2xl font-bold"> </p> <p class="text-sm text-muted-foreground">実行コマンド数</p></div> <div class="text-center"><p class="text-2xl font-bold"> </p> <p class="text-sm text-muted-foreground">実行ターン数</p></div></div>'),ka=d("<!> <!>",1),ba=d('<div class="bg-muted p-4 rounded-lg overflow-auto max-h-96"><pre class="text-xs whitespace-pre-wrap break-words font-mono"> </pre></div>'),ya=d("<!> <!>",1),Pa=d('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><!> <!></div> <!></div> <!>',1),Ta=(z,a)=>window.location.href=`/tasks/${o(a).id||o(a).taskId}`,Ca=d('<button type="button" class="w-full p-4 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer text-left"><div class="flex items-start justify-between"><div class="flex-1 space-y-2"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span></div> <p class="text-sm"> </p></div> <!></div></button>'),Sa=d('<div class="space-y-3"></div>'),Da=d("<!> <!>",1),ja=d("<!> ログをダウンロード",1),Oa=d('<div class="flex items-center justify-between"><!> <!></div>'),Aa=d("<!> ログ",1),Na=d("<!> ",1),Ia=d("<!> ",1),Ra=d("<!> ",1),Ua=d("<!> <!> <!> <!>",1),Fa=d('<div class="whitespace-pre-wrap break-words"> </div>'),Ba=d('<div class="bg-black text-green-400 p-4 rounded-lg font-mono text-xs overflow-x-auto overflow-y-auto max-h-96 space-y-1"></div>'),La=d('<p class="text-muted-foreground text-center py-8">ログがありません</p>'),Ma=d('<span class="text-xs text-muted-foreground"> </span>'),za=d('<div class="mt-2 overflow-auto max-h-32 bg-muted/50 p-2 rounded"><pre class="text-xs whitespace-pre-wrap break-words"> </pre></div>'),Ha=d('<div class="mt-2 text-xs text-destructive break-words"> </div>'),qa=d('<div><div class="flex items-center justify-between"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span></div> <!></div> <!> <!></div>'),Ea=d('<div class="space-y-2 max-h-96 overflow-x-auto overflow-y-auto"></div>'),Va=d('<p class="text-muted-foreground text-center py-8">ツール実行情報がありません</p>'),Ga=d('<div class="p-4 rounded-lg border bg-blue-50 dark:bg-blue-950/20"><div class="flex items-center gap-2 mb-2"><!> <span class="text-xs text-muted-foreground"> <!></span></div> <div class="prose prose-sm dark:prose-invert max-w-none"><p class="whitespace-pre-wrap break-words m-0"> </p></div></div>'),Ja=d('<div class="space-y-4 max-h-96 overflow-auto"></div>'),Wa=d('<p class="text-muted-foreground text-center py-8">Claude応答がありません</p>'),Xa=d('<div class="p-3 rounded-lg border"><div class="flex items-center justify-between"><div class="flex items-center gap-2"><!> <span class="text-sm break-words flex-1"> </span> <!></div> <span class="text-xs text-muted-foreground"> </span></div></div>'),Ka=d('<div class="space-y-2 max-h-96 overflow-x-auto overflow-y-auto"></div>'),Qa=d('<p class="text-muted-foreground text-center py-8">TODO更新がありません</p>'),Ya=d("<!> <!> <!> <!> <!>",1),Za=d("<!> <!>",1),tr=d('<div class="container mx-auto p-4 md:p-6 max-w-7xl"><div class="mb-6"><!> <div class="flex items-center justify-between"><h1 class="text-3xl font-bold">タスク詳細</h1> <div class="flex gap-2"><!> <!></div></div></div> <div class="grid gap-6"><!> <!> <!> <!> <!> <!></div></div>');function Or(z,a){Vt(a,!0);const i=Ne(a.data.task.id);let A=Bt(oe(a.data.task)),H=Bt(oe(a.data.logs||[])),K=Bt(void 0),Z=Bt("logs");qt(()=>{console.log("[TaskDetail] Selected tab changed to:",o(Z))});function at(l){switch(l){case"completed":return"default";case"running":return"secondary";case"failed":return"destructive";case"cancelled":return"outline";default:return"secondary"}}function lt(l){try{return qe(new Date(l),"yyyy/MM/dd HH:mm:ss",{locale:Ee})}catch{return l}}function Nt(l,C=60){if(l.length<=C)return l;const U=l.split("/");if(U[U.length-1].length>C-10)return"..."+l.slice(-(C-3));let q=l;if(l.includes("/Users/")||l.includes("/home/")){const G=l.indexOf("/Users/")>=0?l.indexOf("/Users/"):l.indexOf("/home/"),tt=l.indexOf("/",G+7);tt>0&&l.indexOf("/",tt+1)>0&&(q="~"+l.slice(tt))}if(q.length>C){const G="/"+U.slice(-2).join("/"),tt=C-G.length-3;tt>10?q=q.slice(0,tt)+"..."+G:q="..."+G}return q}async function it(){await ne.fetchTask(a.data.task.id);const l=await zt.getLogs(a.data.task.id);At(H,l.logs||[],!0)}async function It(){confirm("このタスクをキャンセルしますか？")&&(await ne.cancelTask(a.data.task.id),await it())}function wt(){const l=o(H).join(`
`),C=new Blob([l],{type:"text/plain"}),U=URL.createObjectURL(C),X=document.createElement("a");X.href=U,X.download=`task-${a.data.task.id}-logs.txt`,X.click(),URL.revokeObjectURL(U)}qt(()=>{if(i.logs.length>0){const l=o(H).length;if(i.logs.length>l){const C=i.logs.slice(l);At(H,[...o(H),...C],!0),o(K)&&setTimeout(()=>{o(K)&&(o(K).scrollTop=o(K).scrollHeight)},100)}}}),qt(()=>{if(i.statusChange){console.log("[TaskDetail] Status change detected:",i.statusChange);const l=i.statusChange.data?.status||i.statusChange.type==="task:update"&&i.statusChange.data?.status||i.statusChange.type.replace("task:","");l&&At(A,{...o(A),status:l,updatedAt:new Date().toISOString()},!0),["task:completed","task:failed","task:cancelled","completed","failed","cancelled"].includes(l)&&it()}});var Rt=tr(),Ut=s(Rt),dt=s(Ut);Ct(dt,{variant:"ghost",onclick:()=>window.location.href="/tasks",class:"gap-2 mb-4",children:(l,C)=>{var U=ra(),X=m(U);Me(X,{class:"h-4 w-4"}),B(),t(l,U)},$$slots:{default:!0}});var vt=r(dt,2),kt=r(s(vt),2),Qt=s(kt);{var _e=l=>{var C=sa();t(l,C)};L(Qt,l=>{i.connected&&l(_e)})}var fe=r(Qt,2);Ct(fe,{variant:"outline",onclick:it,class:"gap-2",children:(l,C)=>{var U=oa(),X=m(U);ie(X,{class:"h-4 w-4"}),B(),t(l,U)},$$slots:{default:!0}}),e(kt),e(vt),e(Ut);var Yt=r(Ut,2),Zt=s(Yt);O(Zt,()=>Dt,(l,C)=>{C(l,{children:(U,X)=>{var q=ga(),G=m(q);O(G,()=>jt,($,S)=>{S($,{children:(E,p)=>{var g=la(),u=s(g);O(u,()=>Ot,(T,k)=>{k(T,{children:(y,_)=>{B();var D=et("タスク情報");t(y,D)},$$slots:{default:!0}})});var w=r(u,2);{let T=$t(()=>at(o(A).status));gt(w,{get variant(){return o(T)},children:(k,y)=>{B();var _=et();j(()=>h(_,o(A).status)),t(k,_)},$$slots:{default:!0}})}e(g),t(E,g)},$$slots:{default:!0}})});var tt=r(G,2);O(tt,()=>St,($,S)=>{S($,{class:"space-y-4",children:(E,p)=>{var g=fa(),u=m(g),w=r(s(u),2),T=s(w,!0);e(w),e(u);var k=r(u,2);{var y=x=>{var c=na(),P=r(s(c),2);Ct(P,{variant:"link",class:"h-auto p-0 text-primary hover:underline",onclick:()=>window.location.href=`/tasks/${a.data.task.continuedFrom||a.data.task.parentTaskId}`,children:(R,Y)=>{var ut=da(),bt=m(ut);Et(bt,{class:"h-4 w-4 mr-1"});var yt=r(bt);j(()=>h(yt,` ${(a.data.task.continuedFrom||a.data.task.parentTaskId)??""}`)),t(R,ut)},$$slots:{default:!0}}),e(c),t(x,c)};L(k,x=>{(a.data.task.continuedFrom||a.data.task.parentTaskId)&&x(y)})}var _=r(k,2),D=r(s(_),2),N=s(D),F=s(N,!0);e(N),e(D),e(_);var v=r(_,2);{var f=x=>{var c=ia(),P=r(s(c),2),R=s(P);Et(R,{class:"h-4 w-4 text-muted-foreground flex-shrink-0"});var Y=r(R,2),ut=s(Y,!0);e(Y),e(P),e(c),j(bt=>{Se(Y,"title",a.data.task.context?.workingDirectory||a.data.task.workingDirectory),h(ut,bt)},[()=>Nt(a.data.task.context?.workingDirectory||a.data.task.workingDirectory||"")]),t(x,c)};L(v,x=>{(a.data.task.context?.workingDirectory||a.data.task.workingDirectory)&&x(f)})}var M=r(v,2);{var n=x=>{var c=ca(),P=r(s(c),2);Pt(P,21,()=>a.data.task.context.repositories,Tt,(R,Y)=>{gt(R,{variant:"secondary",class:"text-xs",children:(ut,bt)=>{var yt=va(),se=m(yt);Et(se,{class:"h-3 w-3 mr-1"});var $e=r(se);j(we=>h($e,` ${we??""}`),[()=>o(Y).split("/").pop()]),t(ut,yt)},$$slots:{default:!0}})}),e(P),e(c),t(x,c)};L(M,x=>{a.data.task.context?.repositories&&a.data.task.context.repositories.length>0&&x(n)})}var b=r(M,2),I=s(b),st=r(s(I),2),ct=s(st,!0);e(st),e(I);var ot=r(I,2),mt=r(s(ot),2),xt=s(mt,!0);e(mt),e(ot),e(b);var _t=r(b,2);{var ft=x=>{var c=ua(),P=r(s(c),2),R=s(P,!0);e(P),e(c),j(Y=>h(R,Y),[()=>lt(o(A).completedAt)]),t(x,c)};L(_t,x=>{o(A).completedAt&&x(ft)})}var pt=r(_t,2);{var nt=x=>{var c=_a(),P=r(s(c),2),R=s(P,!0);e(P),e(c),j(()=>h(R,a.data.task.error)),t(x,c)};L(pt,x=>{a.data.task.error&&x(nt)})}j((x,c)=>{h(T,a.data.task.id),h(F,a.data.task.instruction),h(ct,x),h(xt,c)},[()=>lt(o(A).createdAt),()=>o(A).updatedAt?lt(o(A).updatedAt):"-"]),t(E,g)},$$slots:{default:!0}})});var J=r(tt,2);{var Q=$=>{var S=V(),E=m(S);O(E,()=>de,(p,g)=>{g(p,{children:(u,w)=>{Ct(u,{variant:"destructive",onclick:It,class:"gap-2",children:(T,k)=>{var y=ma(),_=m(y);ze(_,{class:"h-4 w-4"}),B(),t(T,y)},$$slots:{default:!0}})},$$slots:{default:!0}})}),t($,S)};L(J,$=>{(o(A).status==="running"||o(A).status==="pending")&&$(Q)})}var rt=r(J,2);{var W=$=>{var S=V(),E=m(S);O(E,()=>de,(p,g)=>{g(p,{children:(u,w)=>{Ct(u,{variant:"default",onclick:()=>window.location.href=`/tasks/${a.data.task.id}/continue`,class:"gap-2",children:(T,k)=>{var y=pa(),_=m(y);ie(_,{class:"h-4 w-4"}),B(),t(T,y)},$$slots:{default:!0}})},$$slots:{default:!0}})}),t($,S)};L(rt,$=>{o(A).status==="completed"&&$(W)})}t(U,q)},$$slots:{default:!0}})});var te=r(Zt,2);{var me=l=>{var C=V(),U=m(C);O(U,()=>Dt,(X,q)=>{q(X,{children:(G,tt)=>{var J=$a(),Q=m(J);O(Q,()=>jt,(W,$)=>{$(W,{children:(S,E)=>{var p=V(),g=m(p);O(g,()=>Ot,(u,w)=>{w(u,{children:(T,k)=>{B();var y=et("実行進捗");t(T,y)},$$slots:{default:!0}})}),t(S,p)},$$slots:{default:!0}})});var rt=r(Q,2);O(rt,()=>St,(W,$)=>{$(W,{children:(S,E)=>{var p=ha(),g=s(p),u=s(g),w=s(u),T=s(w,!0);e(w);var k=r(w,2),y=s(k);e(k),e(u);var _=r(u,2);aa(_,{get value(){return i.progress.percent},class:"h-2"}),e(g);var D=r(g,2);{var N=F=>{var v=xa(),f=s(v);ve(f,{class:"h-4 w-4"});var M=r(f,2),n=s(M);e(M),e(v),j(()=>h(n,`ターン ${i.progress.turn??""} / ${i.progress.maxTurns??""}`)),t(F,v)};L(D,F=>{i.progress.turn&&i.progress.maxTurns&&F(N)})}e(p),j(()=>{h(T,i.progress.message),h(y,`${i.progress.percent??""}%`)}),t(S,p)},$$slots:{default:!0}})}),t(G,J)},$$slots:{default:!0}})}),t(l,C)};L(te,l=>{i.progress&&o(A).status==="running"&&l(me)})}var ee=r(te,2);{var pe=l=>{var C=V(),U=m(C);O(U,()=>Dt,(X,q)=>{q(X,{children:(G,tt)=>{var J=ka(),Q=m(J);O(Q,()=>jt,(W,$)=>{$(W,{children:(S,E)=>{var p=V(),g=m(p);O(g,()=>Ot,(u,w)=>{w(u,{children:(T,k)=>{B();var y=et("実行統計");t(T,y)},$$slots:{default:!0}})}),t(S,p)},$$slots:{default:!0}})});var rt=r(Q,2);O(rt,()=>St,(W,$)=>{$(W,{children:(S,E)=>{var p=wa(),g=s(p),u=s(g),w=s(u,!0);e(u),B(2),e(g);var T=r(g,2),k=s(T),y=s(k,!0);e(k),B(2),e(T);var _=r(T,2),D=s(_),N=s(D,!0);e(D),B(2),e(_);var F=r(_,2),v=s(F),f=s(v,!0);e(v),B(2),e(F),e(p),j(()=>{h(w,i.statistics?.totalToolCalls||0),h(y,i.statistics?.modifiedFiles||0),h(N,i.statistics?.totalExecutions||0),h(f,i.statistics?.totalTurns||0)}),t(S,p)},$$slots:{default:!0}})}),t(G,J)},$$slots:{default:!0}})}),t(l,C)};L(ee,l=>{i.statistics&&l(pe)})}var ae=r(ee,2);{var ge=l=>{var C=V(),U=m(C);O(U,()=>Dt,(X,q)=>{q(X,{children:(G,tt)=>{var J=ya(),Q=m(J);O(Q,()=>jt,(W,$)=>{$(W,{children:(S,E)=>{var p=V(),g=m(p);O(g,()=>Ot,(u,w)=>{w(u,{children:(T,k)=>{B();var y=et("実行結果");t(T,y)},$$slots:{default:!0}})}),t(S,p)},$$slots:{default:!0}})});var rt=r(Q,2);O(rt,()=>St,(W,$)=>{$(W,{children:(S,E)=>{var p=ba(),g=s(p),u=s(g,!0);e(g),e(p),j(w=>h(u,w),[()=>JSON.stringify(a.data.task.result,null,2)]),t(S,p)},$$slots:{default:!0}})}),t(G,J)},$$slots:{default:!0}})}),t(l,C)};L(ae,l=>{a.data.task.result&&l(ge)})}var re=r(ae,2);{var xe=l=>{var C=V(),U=m(C);O(U,()=>Dt,(X,q)=>{q(X,{children:(G,tt)=>{var J=Da(),Q=m(J);O(Q,()=>jt,(W,$)=>{$(W,{children:(S,E)=>{var p=Pa(),g=m(p),u=s(g),w=s(u);Ve(w,{class:"h-5 w-5"});var T=r(w,2);O(T,()=>Ot,(_,D)=>{D(_,{children:(N,F)=>{B();var v=et("継続タスク");t(N,v)},$$slots:{default:!0}})}),e(u);var k=r(u,2);gt(k,{variant:"secondary",children:(_,D)=>{B();var N=et();j(()=>h(N,`${a.data.childTasks.length??""} 件`)),t(_,N)},$$slots:{default:!0}}),e(g);var y=r(g,2);O(y,()=>Ae,(_,D)=>{D(_,{children:(N,F)=>{B();var v=et("このタスクから作成された継続タスク");t(N,v)},$$slots:{default:!0}})}),t(S,p)},$$slots:{default:!0}})});var rt=r(Q,2);O(rt,()=>St,(W,$)=>{$(W,{children:(S,E)=>{var p=Sa();Pt(p,21,()=>a.data.childTasks,Tt,(g,u)=>{var w=Ca();w.__click=[Ta,u];var T=s(w),k=s(T),y=s(k),_=s(y);{let M=$t(()=>at(o(u).status));gt(_,{get variant(){return o(M)},children:(n,b)=>{B();var I=et();j(()=>h(I,o(u).status)),t(n,I)},$$slots:{default:!0}})}var D=r(_,2),N=s(D,!0);e(D),e(y);var F=r(y,2),v=s(F,!0);e(F),e(k);var f=r(k,2);Ge(f,{class:"h-5 w-5 text-muted-foreground flex-shrink-0"}),e(T),e(w),j(M=>{h(N,M),h(v,o(u).instruction)},[()=>lt(o(u).createdAt)]),t(g,w)}),e(p),t(S,p)},$$slots:{default:!0}})}),t(G,J)},$$slots:{default:!0}})}),t(l,C)};L(re,l=>{a.data.childTasks&&a.data.childTasks.length>0&&l(xe)})}var he=r(re,2);O(he,()=>Dt,(l,C)=>{C(l,{children:(U,X)=>{var q=Za(),G=m(q);O(G,()=>jt,(J,Q)=>{Q(J,{children:(rt,W)=>{var $=Oa(),S=s($);O(S,()=>Ot,(p,g)=>{g(p,{children:(u,w)=>{B();var T=et("実行詳細");t(u,T)},$$slots:{default:!0}})});var E=r(S,2);Ct(E,{variant:"outline",size:"sm",onclick:wt,class:"gap-2",children:(p,g)=>{var u=ja(),w=m(u);He(w,{class:"h-4 w-4"}),B(),t(p,u)},$$slots:{default:!0}}),e($),t(rt,$)},$$slots:{default:!0}})});var tt=r(G,2);O(tt,()=>St,(J,Q)=>{Q(J,{children:(rt,W)=>{Be(rt,{class:"w-full",get value(){return o(Z)},set value($){At(Z,$,!0)},children:($,S)=>{var E=Ya(),p=m(E);Le(p,{class:"grid w-full grid-cols-2 md:grid-cols-4",children:(k,y)=>{var _=Ua(),D=m(_);Lt(D,{value:"logs",class:"text-xs",children:(f,M)=>{var n=Aa(),b=m(n);Je(b,{class:"h-3 w-3 mr-1"}),B(),t(f,n)},$$slots:{default:!0}});var N=r(D,2);Lt(N,{value:"tools",class:"text-xs",children:(f,M)=>{var n=Na(),b=m(n);ve(b,{class:"h-3 w-3 mr-1"});var I=r(b);j(()=>h(I,` ツール実行 (${i.toolExecutions.length??""})`)),t(f,n)},$$slots:{default:!0}});var F=r(N,2);Lt(F,{value:"claude",class:"text-xs",children:(f,M)=>{var n=Ia(),b=m(n);ce(b,{class:"h-3 w-3 mr-1"});var I=r(b);j(()=>h(I,` Claude応答 (${i.claudeResponses.length??""})`)),t(f,n)},$$slots:{default:!0}});var v=r(F,2);Lt(v,{value:"todos",class:"text-xs",children:(f,M)=>{var n=Ra(),b=m(n);We(b,{class:"h-3 w-3 mr-1"});var I=r(b);j(()=>h(I,` TODO (${i.todoUpdates.length??""})`)),t(f,n)},$$slots:{default:!0}}),t(k,_)},$$slots:{default:!0}});var g=r(p,2);Mt(g,{value:"logs",class:"mt-4",children:(k,y)=>{var _=V(),D=m(_);{var N=v=>{var f=Ba();Pt(f,21,()=>o(H),Tt,(M,n)=>{var b=Fa(),I=s(b,!0);e(b),j(()=>h(I,o(n))),t(M,b)}),e(f),Pe(f,M=>At(K,M),()=>o(K)),t(v,f)},F=v=>{var f=La();t(v,f)};L(D,v=>{o(H).length>0?v(N):v(F,!1)})}t(k,_)},$$slots:{default:!0}});var u=r(g,2);Mt(u,{value:"tools",class:"mt-4",children:(k,y)=>{var _=V(),D=m(_);{var N=v=>{var f=Ea();Pt(f,21,()=>i.toolExecutions,Tt,(M,n)=>{var b=qa(),I=s(b),st=s(I),ct=s(st);{let c=$t(()=>o(n).type==="task:tool:start"?"secondary":"default");gt(ct,{get variant(){return o(c)},children:(P,R)=>{B();var Y=et();j(()=>h(Y,o(n).tool)),t(P,Y)},$$slots:{default:!0}})}var ot=r(ct,2),mt=s(ot,!0);e(ot),e(st);var xt=r(st,2);{var _t=c=>{var P=Ma(),R=s(P);e(P),j(()=>h(R,`${o(n).duration??""}ms`)),t(c,P)};L(xt,c=>{o(n).duration&&c(_t)})}e(I);var ft=r(I,2);{var pt=c=>{var P=za(),R=s(P),Y=s(R,!0);e(R),e(P),j(ut=>h(Y,ut),[()=>JSON.stringify(o(n).args,null,2)]),t(c,P)};L(ft,c=>{o(n).args&&c(pt)})}var nt=r(ft,2);{var x=c=>{var P=Ha(),R=s(P);e(P),j(()=>h(R,`エラー: ${o(n).error??""}`)),t(c,P)};L(nt,c=>{o(n).error&&c(x)})}e(b),j(c=>{De(b,1,`p-3 rounded-lg border ${o(n).type==="task:tool:start"?"bg-muted/50":"bg-green-50 dark:bg-green-950/20"}`),h(mt,c)},[()=>lt(o(n).timestamp)]),t(M,b)}),e(f),t(v,f)},F=v=>{var f=Va();t(v,f)};L(D,v=>{i.toolExecutions.length>0?v(N):v(F,!1)})}t(k,_)},$$slots:{default:!0}});var w=r(u,2);Mt(w,{value:"claude",class:"mt-4",children:(k,y)=>{var _=V(),D=m(_);{var N=v=>{var f=Ja();Pt(f,21,()=>i.claudeResponses,Tt,(M,n)=>{var b=Ga(),I=s(b),st=s(I);ce(st,{class:"h-4 w-4 text-blue-600 dark:text-blue-400"});var ct=r(st,2),ot=s(ct),mt=r(ot);{var xt=nt=>{var x=et();j(()=>h(x,`(ターン ${o(n).turnNumber??""}/${o(n).maxTurns??""})`)),t(nt,x)};L(mt,nt=>{o(n).turnNumber&&o(n).maxTurns&&nt(xt)})}e(ct),e(I);var _t=r(I,2),ft=s(_t),pt=s(ft,!0);e(ft),e(_t),e(b),j(nt=>{h(ot,`${nt??""} `),h(pt,o(n).response)},[()=>lt(o(n).timestamp)]),t(M,b)}),e(f),t(v,f)},F=v=>{var f=Wa();t(v,f)};L(D,v=>{i.claudeResponses.length>0?v(N):v(F,!1)})}t(k,_)},$$slots:{default:!0}});var T=r(w,2);Mt(T,{value:"todos",class:"mt-4",children:(k,y)=>{var _=V(),D=m(_);{var N=v=>{var f=Ka();Pt(f,21,()=>i.todoUpdates,Tt,(M,n)=>{var b=Xa(),I=s(b),st=s(I),ct=s(st);{let x=$t(()=>o(n).status==="completed"?"default":o(n).status==="in_progress"?"secondary":"outline");gt(ct,{get variant(){return o(x)},children:(c,P)=>{B();var R=et();j(()=>h(R,o(n).status==="completed"?"完了":o(n).status==="in_progress"?"進行中":"未実施")),t(c,R)},$$slots:{default:!0}})}var ot=r(ct,2),mt=s(ot,!0);e(ot);var xt=r(ot,2);{var _t=x=>{gt(x,{variant:"destructive",class:"text-xs",children:(c,P)=>{B();var R=et("高");t(c,R)},$$slots:{default:!0}})},ft=x=>{var c=V(),P=m(c);{var R=Y=>{gt(Y,{variant:"secondary",class:"text-xs",children:(ut,bt)=>{B();var yt=et("低");t(ut,yt)},$$slots:{default:!0}})};L(P,Y=>{o(n).priority==="low"&&Y(R)},!0)}t(x,c)};L(xt,x=>{o(n).priority==="high"?x(_t):x(ft,!1)})}e(st);var pt=r(st,2),nt=s(pt,!0);e(pt),e(I),e(b),j(x=>{h(mt,o(n).content),h(nt,x)},[()=>lt(o(n).timestamp)]),t(M,b)}),e(f),t(v,f)},F=v=>{var f=Qa();t(v,f)};L(D,v=>{i.todoUpdates.length>0?v(N):v(F,!1)})}t(k,_)},$$slots:{default:!0}}),t($,E)},$$slots:{default:!0}})},$$slots:{default:!0}})}),t(U,q)},$$slots:{default:!0}})}),e(Yt),e(Rt),t(z,Rt),Gt()}je(["click"]);export{Or as component,jr as universal};
