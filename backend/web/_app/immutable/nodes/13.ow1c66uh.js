import{t as Zt}from"../chunks/8-ECe_Y2.js";import"../chunks/NZTpNUN0.js";import{d as M,e as m,a,h as C,g as r,l as D,k as nt,M as te,aq as mt,p as Y,b as Z,f as _,c as d,n as gt,r as i,s as x,t as K,C as at,B as ut}from"../chunks/CibTsHxy.js";import{a as ot,s as Q}from"../chunks/DMzQSiFV.js";import{l as Bt,s as dt,p as w,i as G,r as it}from"../chunks/D2tfWl3j.js";import{I as Ft,s as Rt,a as zt,i as Et}from"../chunks/BBRwJ9cY.js";import{c as R}from"../chunks/Dmq7Nx9n.js";import{B as pt}from"../chunks/BkNxBhzy.js";import{B as Dt,C as ee,a as re}from"../chunks/Bvs5g0ah.js";import{C as se}from"../chunks/DP_CO7Qi.js";import{C as ae,a as ne}from"../chunks/CeXjzowc.js";import"../chunks/C4ObHWRh.js";import{d as oe}from"../chunks/BTv9tsTU.js";import{a as _t,e as At}from"../chunks/BR09V1wi.js";import{a as bt,h as kt,l as xt,n as ie,c as le,w as St,d as A,b as wt,m as yt}from"../chunks/CvxMnhAS.js";import{C as de,S as ce,d as ve,n as jt}from"../chunks/iNO-dr0C.js";import{a as ue,O as he,P as fe,C as pe}from"../chunks/BUDdbBSC.js";import{C as me}from"../chunks/BST5KIEH.js";import{G as qt}from"../chunks/BPKQsP3q.js";import"../chunks/B5zMa-mz.js";import{f as ge,j as _e}from"../chunks/C74-udT0.js";import{R as be}from"../chunks/CVkBE2Ak.js";function ke(u,t){const s=Bt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["circle",{cx:"12",cy:"12",r:"10"}]];Ft(u,dt({name:"circle"},()=>s,{get iconNode(){return n},children:(o,v)=>{var c=M(),h=m(c);Rt(h,t,"default",{}),a(o,c)},$$slots:{default:!0}}))}function xe(u,t){const s=Bt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M3 12h.01"}],["path",{d:"M3 18h.01"}],["path",{d:"M3 6h.01"}],["path",{d:"M8 12h13"}],["path",{d:"M8 18h13"}],["path",{d:"M8 6h13"}]];Ft(u,dt({name:"list"},()=>s,{get iconNode(){return n},children:(o,v)=>{var c=M(),h=m(c);Rt(h,t,"default",{}),a(o,c)},$$slots:{default:!0}}))}const Ct=le({component:"collapsible",parts:["root","content","trigger"]}),Pt=new de("Collapsible.Root");class Ot{static create(t){return Pt.set(new Ot(t))}opts;attachment;#t=nt(null);get contentNode(){return r(this.#t)}set contentNode(t){D(this.#t,t,!0)}#e=nt(void 0);get contentId(){return r(this.#e)}set contentId(t){D(this.#e,t,!0)}constructor(t){this.opts=t,this.toggleOpen=this.toggleOpen.bind(this),this.attachment=bt(this.opts.ref),new he({ref:A.with(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}})}toggleOpen(){this.opts.open.current=!this.opts.open.current}#r=C(()=>({id:this.opts.id.current,"data-state":xt(this.opts.open.current),"data-disabled":kt(this.opts.disabled.current),[Ct.root]:"",...this.attachment}));get props(){return r(this.#r)}set props(t){D(this.#r,t)}}class Mt{static create(t){return new Mt(t,Pt.get())}opts;root;attachment;#t=C(()=>this.opts.forceMount.current||this.root.opts.open.current);get present(){return r(this.#t)}set present(t){D(this.#t,t)}#e;#r=nt(!1);#s=nt(0);#a=nt(0);constructor(t,s){this.opts=t,this.root=s,D(this.#r,s.opts.open.current,!0),this.root.contentId=this.opts.id.current,this.attachment=bt(this.opts.ref,n=>this.root.contentNode=n),St.pre(()=>this.opts.id.current,n=>{this.root.contentId=n}),te(()=>{const n=requestAnimationFrame(()=>{D(this.#r,!1)});return()=>{cancelAnimationFrame(n)}}),St([()=>this.opts.ref.current,()=>this.present],([n])=>{n&&ue(()=>{if(!this.opts.ref.current)return;this.#e=this.#e||{transitionDuration:n.style.transitionDuration,animationName:n.style.animationName},n.style.transitionDuration="0s",n.style.animationName="none";const o=n.getBoundingClientRect();if(D(this.#a,o.height,!0),D(this.#s,o.width,!0),!r(this.#r)){const{animationName:v,transitionDuration:c}=this.#e;n.style.transitionDuration=c,n.style.animationName=v}})})}#n=C(()=>({open:this.root.opts.open.current}));get snippetProps(){return r(this.#n)}set snippetProps(t){D(this.#n,t)}#o=C(()=>({id:this.opts.id.current,style:{"--bits-collapsible-content-height":r(this.#a)?`${r(this.#a)}px`:void 0,"--bits-collapsible-content-width":r(this.#s)?`${r(this.#s)}px`:void 0},"data-state":xt(this.root.opts.open.current),"data-disabled":kt(this.root.opts.disabled.current),[Ct.content]:"",...this.attachment}));get props(){return r(this.#o)}set props(t){D(this.#o,t)}}class $t{static create(t){return new $t(t,Pt.get())}opts;root;attachment;#t=C(()=>this.opts.disabled.current||this.root.opts.disabled.current);constructor(t,s){this.opts=t,this.root=s,this.attachment=bt(this.opts.ref),this.onclick=this.onclick.bind(this),this.onkeydown=this.onkeydown.bind(this)}onclick(t){if(!r(this.#t)){if(t.button!==0)return t.preventDefault();this.root.toggleOpen()}}onkeydown(t){r(this.#t)||(t.key===ce||t.key===ve)&&(t.preventDefault(),this.root.toggleOpen())}#e=C(()=>({id:this.opts.id.current,type:"button",disabled:r(this.#t),"aria-controls":this.root.contentId,"aria-expanded":ie(this.root.opts.open.current),"data-state":xt(this.root.opts.open.current),"data-disabled":kt(r(this.#t)),[Ct.trigger]:"",onclick:this.onclick,onkeydown:this.onkeydown,...this.attachment}));get props(){return r(this.#e)}set props(t){D(this.#e,t)}}var we=_("<div><!></div>");function ye(u,t){const s=mt();Y(t,!0);let n=w(t,"id",19,()=>wt(s)),o=w(t,"ref",15,null),v=w(t,"open",15,!1),c=w(t,"disabled",3,!1),h=w(t,"onOpenChange",3,jt),g=w(t,"onOpenChangeComplete",3,jt),y=it(t,["$$slots","$$events","$$legacy","children","child","id","ref","open","disabled","onOpenChange","onOpenChangeComplete"]);const z=Ot.create({open:A.with(()=>v(),e=>{v(e),h()(e)}),disabled:A.with(()=>c()),id:A.with(()=>n()),ref:A.with(()=>o(),e=>o(e)),onOpenChangeComplete:A.with(()=>g())}),k=C(()=>yt(y,z.props));var P=M(),f=m(P);{var b=e=>{var l=M(),p=m(l);ot(p,()=>t.child,()=>({props:r(k)})),a(e,l)},T=e=>{var l=we();_t(l,()=>({...r(k)}));var p=d(l);ot(p,()=>t.children??gt),i(l),a(e,l)};G(f,e=>{t.child?e(b):e(T,!1)})}a(u,P),Z()}var Ce=_("<div><!></div>");function Pe(u,t){const s=mt();Y(t,!0);let n=w(t,"ref",15,null),o=w(t,"forceMount",3,!1),v=w(t,"id",19,()=>wt(s)),c=it(t,["$$slots","$$events","$$legacy","child","ref","forceMount","children","id"]);const h=Mt.create({id:A.with(()=>v()),forceMount:A.with(()=>o()),ref:A.with(()=>n(),g=>n(g))});fe(u,{forceMount:!0,get open(){return h.present},get ref(){return h.opts.ref},presence:(y,z)=>{let k=()=>z?.().present;var P=M();const f=C(()=>yt(c,h.props,{hidden:o()?void 0:!k()}));var b=m(P);{var T=l=>{var p=M(),S=m(p);{let j=C(()=>({...h.snippetProps,props:r(f)}));ot(S,()=>t.child,()=>r(j))}a(l,p)},e=l=>{var p=Ce();_t(p,()=>({...r(f)}));var S=d(p);ot(S,()=>t.children??gt),i(p),a(l,p)};G(b,l=>{t.child?l(T):l(e,!1)})}a(y,P)},$$slots:{presence:!0}}),Z()}var Oe=_("<button><!></button>");function Me(u,t){const s=mt();Y(t,!0);let n=w(t,"ref",15,null),o=w(t,"id",19,()=>wt(s)),v=w(t,"disabled",3,!1),c=it(t,["$$slots","$$events","$$legacy","children","child","ref","id","disabled"]);const h=$t.create({id:A.with(()=>o()),ref:A.with(()=>n(),f=>n(f)),disabled:A.with(()=>v())}),g=C(()=>yt(c,h.props));var y=M(),z=m(y);{var k=f=>{var b=M(),T=m(b);ot(T,()=>t.child,()=>({props:r(g)})),a(f,b)},P=f=>{var b=Oe();_t(b,()=>({...r(g)}));var T=d(b);ot(T,()=>t.children??gt),i(b),a(f,b)};G(z,f=>{t.child?f(k):f(P,!1)})}a(u,y),Z()}function $e(u,t){Y(t,!0);let s=w(t,"ref",15,null),n=w(t,"open",15,!1),o=it(t,["$$slots","$$events","$$legacy","ref","open"]);var v=M(),c=m(v);R(c,()=>ye,(h,g)=>{g(h,dt({"data-slot":"collapsible"},()=>o,{get ref(){return s()},set ref(y){s(y)},get open(){return n()},set open(y){n(y)}}))}),a(u,v),Z()}function Ne(u,t){Y(t,!0);let s=w(t,"ref",15,null),n=it(t,["$$slots","$$events","$$legacy","ref"]);var o=M(),v=m(o);R(v,()=>Me,(c,h)=>{h(c,dt({"data-slot":"collapsible-trigger"},()=>n,{get ref(){return s()},set ref(g){s(g)}}))}),a(u,o),Z()}function Te(u,t){Y(t,!0);let s=w(t,"ref",15,null),n=it(t,["$$slots","$$events","$$legacy","ref"]);var o=M(),v=m(o);R(v,()=>Pe,(c,h)=>{h(c,dt({"data-slot":"collapsible-content"},()=>n,{get ref(){return s()},set ref(g){s(g)}}))}),a(u,o),Z()}const Ie=async()=>{try{return{tasks:(await Zt.list({limit:1e3})).data||[]}}catch(u){return console.error("Failed to load tasks:",u),{tasks:[]}}},_r=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"}));var De=_('<div class="absolute left-0 top-0 w-6 h-6 border-l-2 border-b-2 border-muted-foreground/30 rounded-bl-lg"></div>'),Ae=(u,t,s)=>t(s.task.id||s.task.taskId),Se=_('<div class="flex items-center gap-1 text-xs text-muted-foreground"><!> <span> </span></div>'),je=_('<div class="absolute left-0 top-6 bottom-0 w-px bg-muted-foreground/30" style="margin-left: 0.75rem;"></div>'),Be=_('<div class="relative"><!> <!></div>'),Fe=_('<p class="text-sm text-muted-foreground ml-6"> </p>'),Re=_('<div class="mt-3 space-y-3 relative"><!></div>'),ze=_('<div class="flex items-start gap-2"><!> <button type="button" class="flex-1 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer text-left"><div class="flex items-start justify-between"><div class="flex-1 space-y-1"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span> <!></div> <p class="text-sm line-clamp-2"> </p></div></div></button></div> <!>',1),Ee=(u,t,s)=>t(s.task.id||s.task.taskId),qe=_('<div class="flex items-start gap-2"><div class="h-6 w-6 flex items-center justify-center"><!></div> <button type="button" class="flex-1 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer text-left"><div class="flex items-start justify-between"><div class="flex-1 space-y-1"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span></div> <p class="text-sm line-clamp-2"> </p></div></div></button></div>'),Ge=_('<div class="relative"><!> <div><!></div></div>');function Gt(u,t){Y(t,!0);let s=w(t,"depth",3,0),n=C(()=>t.allTasks.filter(e=>e.continuedFrom===t.task.id||e.parentTaskId===t.task.id)),o=C(()=>({...t.task,children:r(n).map(e=>({...e,children:t.allTasks.filter(l=>l.continuedFrom===e.id||l.parentTaskId===e.id)}))})),v=nt(s()<2);function c(e){switch(e){case"completed":return"default";case"running":return"secondary";case"failed":return"destructive";case"cancelled":return"outline";default:return"secondary"}}function h(e){try{return ge(new Date(e),"MM/dd HH:mm",{locale:_e})}catch{return e}}function g(e){window.location.href=`/tasks/${e}`}var y=Ge(),z=d(y);{var k=e=>{var l=De();K(()=>At(l,`margin-left: ${(s()-1)*1.5}rem; margin-top: -0.75rem;`)),a(e,l)};G(z,e=>{s()>0&&e(k)})}var P=x(z,2),f=d(P);{var b=e=>{var l=M(),p=m(l);R(p,()=>$e,(S,j)=>{j(S,{get open(){return r(v)},set open(U){D(v,U,!0)},children:(U,H)=>{var I=ze(),B=m(I),L=d(B);R(L,()=>Ne,(F,J)=>{J(F,{children:(tt,et)=>{pt(tt,{variant:"ghost",size:"icon",class:"h-6 w-6 p-0",children:(rt,Tt)=>{var vt=M(),ht=m(vt);{var W=q=>{pe(q,{class:"h-4 w-4"})},X=q=>{me(q,{class:"h-4 w-4"})};G(ht,q=>{r(v)?q(W):q(X,!1)})}a(rt,vt)},$$slots:{default:!0}})},$$slots:{default:!0}})});var $=x(L,2);$.__click=[Ae,g,t];var O=d($),E=d(O),N=d(E),st=d(N);{let F=C(()=>c(t.task.status));Dt(st,{get variant(){return r(F)},children:(J,tt)=>{at();var et=ut();K(()=>Q(et,t.task.status)),a(J,et)},$$slots:{default:!0}})}var V=x(st,2),ct=d(V,!0);i(V);var Ht=x(V,2);{var Lt=F=>{var J=Se(),tt=d(J);qt(tt,{class:"h-3 w-3"});var et=x(tt,2),rt=d(et);i(et),i(J),K(()=>Q(rt,`${r(o).children.length??""} 継続`)),a(F,J)};G(Ht,F=>{r(o).children.length>0&&F(Lt)})}i(N);var Nt=x(N,2),Vt=d(Nt,!0);i(Nt),i(E),i(O),i($),i(B);var Jt=x(B,2);R(Jt,()=>Te,(F,J)=>{J(F,{children:(tt,et)=>{var rt=Re(),Tt=d(rt);{var vt=W=>{var X=M(),q=m(X);zt(q,17,()=>r(o).children,Et,(Kt,Qt,Ut)=>{var ft=Be(),It=d(ft);{var Wt=lt=>{var Yt=je();a(lt,Yt)};G(It,lt=>{Ut<r(o).children.length-1&&lt(Wt)})}var Xt=x(It,2);{let lt=C(()=>s()+1);Gt(Xt,{get task(){return r(Qt)},get allTasks(){return t.allTasks},get depth(){return r(lt)}})}i(ft),a(Kt,ft)}),a(W,X)},ht=W=>{var X=Fe(),q=d(X);i(X),K(()=>Q(q,`さらに ${r(o).children.length??""} 件の継続タスク...`)),a(W,X)};G(Tt,W=>{s()<5?W(vt):W(ht,!1)})}i(rt),a(tt,rt)},$$slots:{default:!0}})}),K(F=>{Q(ct,F),Q(Vt,t.task.instruction)},[()=>h(t.task.createdAt)]),a(U,I)},$$slots:{default:!0}})}),a(e,l)},T=e=>{var l=qe(),p=d(l),S=d(p);ke(S,{class:"h-2 w-2 fill-current text-muted-foreground"}),i(p);var j=x(p,2);j.__click=[Ee,g,t];var U=d(j),H=d(U),I=d(H),B=d(I);{let N=C(()=>c(t.task.status));Dt(B,{get variant(){return r(N)},children:(st,V)=>{at();var ct=ut();K(()=>Q(ct,t.task.status)),a(st,ct)},$$slots:{default:!0}})}var L=x(B,2),$=d(L,!0);i(L),i(I);var O=x(I,2),E=d(O,!0);i(O),i(H),i(U),i(j),i(l),K(N=>{Q($,N),Q(E,t.task.instruction)},[()=>h(t.task.createdAt)]),a(e,l)};G(f,e=>{r(o).children&&r(o).children.length>0?e(b):e(T,!1)})}i(P),i(y),K(()=>At(P,`margin-left: ${s()*1.5}rem;`)),a(u,y),Z()}oe(["click"]);var He=_("<!> リスト表示",1),Le=_("<!> 更新",1),Ve=_('<div class="flex items-center gap-2"><!> <!></div> <!>',1),Je=_('<div class="space-y-4"></div>'),Ke=_('<p class="text-center text-muted-foreground py-8">タスクがありません</p>'),Qe=_("<!> <!>",1),Ue=_('<div class="space-y-6"><div class="flex justify-between items-center"><div><h2 class="text-3xl font-bold tracking-tight">タスクツリー</h2> <p class="text-muted-foreground">タスクの継続関係をツリー表示</p></div> <div class="flex gap-2"><!> <!></div></div> <!></div>');function br(u,t){Y(t,!0);let s=C(()=>t.data.tasks.filter(k=>!k.continuedFrom&&!k.parentTaskId));function n(){window.location.reload()}function o(){window.location.href="/tasks"}var v=Ue(),c=d(v),h=x(d(c),2),g=d(h);pt(g,{variant:"outline",onclick:o,children:(k,P)=>{var f=He(),b=m(f);xe(b,{class:"mr-2 h-4 w-4"}),at(),a(k,f)},$$slots:{default:!0}});var y=x(g,2);pt(y,{variant:"outline",onclick:n,children:(k,P)=>{var f=Le(),b=m(f);be(b,{class:"mr-2 h-4 w-4"}),at(),a(k,f)},$$slots:{default:!0}}),i(h),i(c);var z=x(c,2);R(z,()=>re,(k,P)=>{P(k,{children:(f,b)=>{var T=Qe(),e=m(T);R(e,()=>ae,(p,S)=>{S(p,{children:(j,U)=>{var H=Ve(),I=m(H),B=d(I);qt(B,{class:"h-5 w-5"});var L=x(B,2);R(L,()=>ne,(O,E)=>{E(O,{children:(N,st)=>{at();var V=ut("タスク継続関係");a(N,V)},$$slots:{default:!0}})}),i(I);var $=x(I,2);R($,()=>se,(O,E)=>{E(O,{children:(N,st)=>{at();var V=ut();K(()=>Q(V,`${r(s).length??""} 件のルートタスク（全 ${t.data.tasks.length??""} 件）`)),a(N,V)},$$slots:{default:!0}})}),a(j,H)},$$slots:{default:!0}})});var l=x(e,2);R(l,()=>ee,(p,S)=>{S(p,{children:(j,U)=>{var H=M(),I=m(H);{var B=$=>{var O=Je();zt(O,21,()=>r(s),Et,(E,N)=>{Gt(E,{get task(){return r(N)},get allTasks(){return t.data.tasks}})}),i(O),a($,O)},L=$=>{var O=Ke();a($,O)};G(I,$=>{r(s).length>0?$(B):$(L,!1)})}a(j,H)},$$slots:{default:!0}})}),a(f,T)},$$slots:{default:!0}})}),i(v),a(u,v),Z()}export{br as component,_r as universal};
