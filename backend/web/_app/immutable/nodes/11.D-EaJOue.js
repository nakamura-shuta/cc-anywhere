import"../chunks/NZTpNUN0.js";import{p as Re,m as Ae,k as I,l as C,f as i,e as u,C as d,B as g,a as r,s as a,d as fe,g as e,c as n,r as s,t as J,h as ne,b as ze}from"../chunks/CibTsHxy.js";import{o as We,s as N}from"../chunks/DMzQSiFV.js";import{a as De,i as Me}from"../chunks/BBRwJ9cY.js";import{c as F}from"../chunks/Dmq7Nx9n.js";import{e as Xe}from"../chunks/BTv9tsTU.js";import{g as we}from"../chunks/BXVAK8Uf.js";import{B as Se}from"../chunks/BkNxBhzy.js";import{a as Je,C as Ne,B as Be}from"../chunks/Bvs5g0ah.js";import{C as Ge}from"../chunks/DP_CO7Qi.js";import{C as He,a as Ke}from"../chunks/CeXjzowc.js";import{I as Ee}from"../chunks/CU3n_vQS.js";import{L as ie,T as Ye}from"../chunks/CqC_3kme.js";import{R as Ze,S as er,a as rr,b as tr}from"../chunks/CQKzkG8V.js";import{t as ar}from"../chunks/BtUCVySZ.js";import{p as qe,i as le}from"../chunks/D2tfWl3j.js";import{s as sr}from"../chunks/BR09V1wi.js";import{r as or}from"../chunks/Cm2qQ51_.js";import{S as je,A as Fe,a as Ie,C as Le,b as lr}from"../chunks/CzW9l4YM.js";import{C as Oe,a as nr}from"../chunks/tyYiYgul.js";import{F as ir,C as dr}from"../chunks/DpKdUl5G.js";import{A as vr}from"../chunks/sbTcS15C.js";const cr=!1,ur=async()=>({}),tt=Object.freeze(Object.defineProperty({__proto__:null,load:ur,prerender:cr},Symbol.toStringTag,{value:"Module"}));var _r=i("<!> <!>",1),fr=i('<div class="flex items-center space-x-2"><!> <!></div>'),mr=i('<div class="space-y-2"></div>'),pr=i("<!> <!>",1),$r=i("<!> <!>",1),gr=i('<!> <span class="font-medium"> </span>',1),hr=i("<!> 選択中",1),xr=i("<!> 利用不可",1),br=i('<div><!> <div class="flex-1 min-w-0"><!> <p class="text-xs text-muted-foreground truncate mt-1"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div>'),yr=i('<div class="pt-4 border-t"><p class="text-sm text-muted-foreground">選択された作業ディレクトリ: <span class="font-medium text-foreground"> </span></p></div>'),Pr=i('<div class="space-y-4"><div class="flex items-center space-x-2 pb-2 border-b"><!> <!></div> <div class="space-y-2"></div> <!></div>'),kr=i("<!> <!>",1);function Cr(ye,de){Re(de,!0);let o=qe(de,"selectedDirectories",31,()=>Ae([])),L=qe(de,"onSelectionChange",3,()=>{}),b=I(Ae([])),G=I(!0),ve=I(null),w=ne(()=>e(b).length>0&&e(b).every(v=>o().includes(v.path))),me=ne(()=>o().length>0&&o().length<e(b).length);We(async()=>{try{C(b,await or.list(),!0),C(G,!1)}catch(v){C(ve,v instanceof Error?v.message:"作業ディレクトリの取得に失敗しました",!0),C(G,!1)}});function pe(v){o().includes(v)?o(o().filter(ee=>ee!==v)):o([...o(),v]),L()(o())}function H(){e(w)?o([]):o(e(b).map(v=>v.path)),L()(o())}function Pe(v){return!0}Je(ye,{children:(v,ee)=>{var $e=kr(),ge=u($e);He(ge,{children:(E,q)=>{var O=_r(),K=u(O);Ke(K,{children:(Q,y)=>{d();var f=g("作業ディレクトリ選択");r(Q,f)},$$slots:{default:!0}});var re=a(K,2);Ge(re,{children:(Q,y)=>{d();var f=g("タスクを実行する作業ディレクトリを選択してください");r(Q,f)},$$slots:{default:!0}}),r(E,O)},$$slots:{default:!0}});var B=a(ge,2);Ne(B,{children:(E,q)=>{var O=fe(),K=u(O);{var re=y=>{var f=mr();De(f,20,()=>Array(3),Me,(U,he)=>{var h=fr(),_=n(h);je(_,{class:"h-4 w-4"});var S=a(_,2);je(S,{class:"h-4 flex-1"}),s(h),r(U,h)}),s(f),r(y,f)},Q=y=>{var f=fe(),U=u(f);{var he=_=>{Fe(_,{variant:"destructive",children:(S,R)=>{var A=pr(),P=u(A);Oe(P,{class:"h-4 w-4"});var m=a(P,2);Ie(m,{children:(p,V)=>{d();var D=g();J(()=>N(D,e(ve))),r(p,D)},$$slots:{default:!0}}),r(S,A)},$$slots:{default:!0}})},h=_=>{var S=fe(),R=u(S);{var A=m=>{Fe(m,{children:(p,V)=>{var D=$r(),W=u(D);Oe(W,{class:"h-4 w-4"});var X=a(W,2);Ie(X,{children:(Y,ce)=>{d();var M=g("作業ディレクトリが設定されていません。backend/config/repositories.jsonを確認してください。");r(Y,M)},$$slots:{default:!0}}),r(p,D)},$$slots:{default:!0}})},P=m=>{var p=Pr(),V=n(p),D=n(V);Le(D,{get checked(){return e(w)},get indeterminate(){return e(me)},onCheckedChange:H});var W=a(D,2);ie(W,{class:"text-sm font-medium cursor-pointer",onclick:H,children:(M,$)=>{d();var x=g();J(()=>N(x,`すべて選択 (${o().length??""}/${e(b).length??""})`)),r(M,x)},$$slots:{default:!0}}),s(V);var X=a(V,2);De(X,21,()=>e(b),Me,(M,$)=>{var x=br();const z=ne(()=>o().includes(e($).path)),t=ne(()=>Pe(e($)));var T=n(x);{let c=ne(()=>!e(t));Le(T,{get checked(){return e(z)},get disabled(){return e(c)},onCheckedChange:()=>pe(e($).path)})}var l=a(T,2),te=n(l);ie(te,{class:"flex items-center gap-2 cursor-pointer",onclick:()=>e(t)&&pe(e($).path),children:(c,se)=>{var oe=gr(),k=u(oe);ir(k,{class:"h-4 w-4 text-muted-foreground flex-shrink-0"});var j=a(k,2),Ce=n(j,!0);s(j),J(()=>N(Ce,e($).name)),r(c,oe)},$$slots:{default:!0}});var Z=a(te,2),xe=n(Z,!0);s(Z),s(l);var be=a(l,2),ae=n(be);{var ue=c=>{Be(c,{variant:"secondary",class:"text-xs",children:(se,oe)=>{var k=hr(),j=u(k);nr(j,{class:"h-3 w-3 mr-1"}),d(),r(se,k)},$$slots:{default:!0}})};le(ae,c=>{e(z)&&c(ue)})}var _e=a(ae,2);{var ke=c=>{Be(c,{variant:"destructive",class:"text-xs",children:(se,oe)=>{var k=xr(),j=u(k);dr(j,{class:"h-3 w-3 mr-1"}),d(),r(se,k)},$$slots:{default:!0}})};le(_e,c=>{e(t)||c(ke)})}s(be),s(x),J(()=>{sr(x,1,`flex items-center space-x-3 p-3 rounded-lg border transition-colors ${e(z)?"bg-muted/50 border-primary/20":"hover:bg-muted/30"}`),N(xe,e($).path)}),r(M,x)}),s(X);var Y=a(X,2);{var ce=M=>{var $=yr(),x=n($),z=a(n(x)),t=n(z);s(z),s(x),s($),J(()=>N(t,`${o().length??""}個`)),r(M,$)};le(Y,M=>{o().length>0&&M(ce)})}s(p),r(m,p)};le(R,m=>{e(b).length===0?m(A):m(P,!1)},!0)}r(_,S)};le(U,_=>{e(ve)?_(he):_(h,!1)},!0)}r(y,f)};le(K,y=>{e(G)?y(re):y(Q,!1)})}r(E,O)},$$slots:{default:!0}}),r(v,$e)},$$slots:{default:!0}}),ze()}var wr=i("<!> タスク一覧に戻る",1),Sr=i("<!> <!>",1),Ar=i("<!> <!>",1),Dr=i("<!> ",1),Mr=i('<form class="space-y-6"><div class="space-y-2"><!> <!></div> <!> <div class="grid grid-cols-2 gap-4"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div></div> <div class="space-y-2"><!> <!></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Tr=i("<!> <!>",1),Br=i('<div class="container mx-auto p-6 max-w-2xl"><div class="mb-6"><!> <h1 class="text-3xl font-bold">新規タスク作成</h1></div> <!></div>');function at(ye,de){Re(de,!0);let o=I(""),L=I(Ae([])),b=I(30),G=I(3e5),ve=!0,w=I("allow");const me=[{value:"ask",label:"確認する (ask)"},{value:"allow",label:"すべて許可 (allow)"},{value:"deny",label:"すべて拒否 (deny)"},{value:"bypassPermissions",label:"権限バイパス (bypassPermissions)"},{value:"acceptEdits",label:"編集を受け入れる (acceptEdits)"},{value:"plan",label:"計画モード (plan)"}],pe=ne(()=>me.find(B=>B.value===e(w))?.label??"権限モードを選択");let H=I(!1);async function Pe(B){if(B.preventDefault(),!e(o).trim()){alert("指示内容を入力してください");return}if(e(L).length===0){alert("作業ディレクトリを選択してください");return}C(H,!0);const E={instruction:e(o).trim(),context:{workingDirectory:e(L)[0],files:[]},options:{timeout:e(G),async:ve,sdk:{maxTurns:e(b),permissionMode:Array.isArray(e(w))?e(w)[0]:e(w)}}};console.log("Creating task with request:",JSON.stringify(E,null,2)),console.log("Permission mode type:",typeof e(w),"value:",e(w));try{(await ar.createTask(E)).data&&we("/tasks")}catch(q){console.error("Failed to create task:",q),alert("タスクの作成に失敗しました")}finally{C(H,!1)}}var v=Br(),ee=n(v),$e=n(ee);Se($e,{variant:"ghost",onclick:()=>we("/tasks"),class:"gap-2 mb-4",children:(B,E)=>{var q=wr(),O=u(q);vr(O,{class:"h-4 w-4"}),d(),r(B,q)},$$slots:{default:!0}}),d(2),s(ee);var ge=a(ee,2);F(ge,()=>Je,(B,E)=>{E(B,{children:(q,O)=>{var K=Tr(),re=u(K);F(re,()=>He,(y,f)=>{f(y,{children:(U,he)=>{var h=Sr(),_=u(h);F(_,()=>Ke,(R,A)=>{A(R,{children:(P,m)=>{d();var p=g("タスク設定");r(P,p)},$$slots:{default:!0}})});var S=a(_,2);F(S,()=>Ge,(R,A)=>{A(R,{children:(P,m)=>{d();var p=g("実行したいタスクの内容を入力してください");r(P,p)},$$slots:{default:!0}})}),r(U,h)},$$slots:{default:!0}})});var Q=a(re,2);F(Q,()=>Ne,(y,f)=>{f(y,{children:(U,he)=>{var h=Mr(),_=n(h),S=n(_);ie(S,{for:"instruction",class:"required",children:(t,T)=>{d();var l=g("指示内容");r(t,l)},$$slots:{default:!0}});var R=a(S,2);Ye(R,{id:"instruction",placeholder:"例: README.mdファイルを作成してください",rows:4,required:!0,class:"resize-none",get value(){return e(o)},set value(t){C(o,t,!0)}}),s(_);var A=a(_,2);Cr(A,{onSelectionChange:t=>{C(L,t,!0)},get selectedDirectories(){return e(L)},set selectedDirectories(t){C(L,t,!0)}});var P=a(A,2),m=n(P),p=n(m);ie(p,{for:"maxTurns",children:(t,T)=>{d();var l=g("最大ターン数");r(t,l)},$$slots:{default:!0}});var V=a(p,2);Ee(V,{id:"maxTurns",type:"number",min:1,max:100,get value(){return e(b)},set value(t){C(b,t,!0)}}),s(m);var D=a(m,2),W=n(D);ie(W,{for:"timeout",children:(t,T)=>{d();var l=g("タイムアウト (ms)");r(t,l)},$$slots:{default:!0}});var X=a(W,2);Ee(X,{id:"timeout",type:"number",min:1e3,step:1e3,get value(){return e(G)},set value(t){C(G,t,!0)}}),s(D),s(P);var Y=a(P,2),ce=n(Y);ie(ce,{for:"permissionMode",children:(t,T)=>{d();var l=g("権限モード");r(t,l)},$$slots:{default:!0}});var M=a(ce,2);F(M,()=>Ze,(t,T)=>{T(t,{type:"single",get value(){return e(w)},set value(l){C(w,l,!0)},children:(l,te)=>{var Z=Ar(),xe=u(Z);F(xe,()=>er,(ae,ue)=>{ue(ae,{id:"permissionMode",children:(_e,ke)=>{d();var c=g();J(()=>N(c,e(pe))),r(_e,c)},$$slots:{default:!0}})});var be=a(xe,2);F(be,()=>rr,(ae,ue)=>{ue(ae,{children:(_e,ke)=>{var c=fe(),se=u(c);De(se,17,()=>me,Me,(oe,k)=>{var j=fe(),Ce=u(j);F(Ce,()=>tr,(Qe,Ue)=>{Ue(Qe,{get value(){return e(k).value},get label(){return e(k).label},children:(Ve,Er)=>{d();var Te=g();J(()=>N(Te,e(k).label)),r(Ve,Te)},$$slots:{default:!0}})}),r(oe,j)}),r(_e,c)},$$slots:{default:!0}})}),r(l,Z)},$$slots:{default:!0}})}),s(Y);var $=a(Y,2),x=n($);Se(x,{type:"submit",get disabled(){return e(H)},class:"gap-2",children:(t,T)=>{var l=Dr(),te=u(l);lr(te,{class:"h-4 w-4"});var Z=a(te);J(()=>N(Z,` ${e(H)?"作成中...":"タスクを作成"}`)),r(t,l)},$$slots:{default:!0}});var z=a(x,2);Se(z,{type:"button",variant:"outline",onclick:()=>we("/tasks"),children:(t,T)=>{d();var l=g("キャンセル");r(t,l)},$$slots:{default:!0}}),s($),s(h),Xe("submit",h,Pe),r(U,h)},$$slots:{default:!0}})}),r(q,K)},$$slots:{default:!0}})}),s(v),r(ye,v),ze()}export{at as component,tt as universal};
