import"../chunks/NZTpNUN0.js";import{p as Re,j as Ae,g as I,i as C,f as i,e as u,y as d,x as g,a as t,s as a,d as fe,h as e,c as n,r as s,t as J,V as ne,b as ze}from"../chunks/DsgVtOPg.js";import{o as We,s as N}from"../chunks/2BTfzV6r.js";import{e as De,i as Me}from"../chunks/Ctyd3DqP.js";import{c as F}from"../chunks/DYtQPdT-.js";import{e as Xe}from"../chunks/CDdHQTXV.js";import{g as we}from"../chunks/BYf8mAc-.js";import{B as Se}from"../chunks/Dgibhu4a.js";import{c as Je,C as Ne,a as Ve,b as Ge,B as Ee}from"../chunks/B6-b1C0K.js";import{C as He}from"../chunks/DC4utYBl.js";import{C as je,a as Ye,I as qe,R as Ze,S as et,b as tt,c as rt}from"../chunks/CYlRkfvg.js";import{L as ie,T as at}from"../chunks/BEnxKUvc.js";import{t as st}from"../chunks/DSn_KTov.js";import{p as Be,i as le}from"../chunks/8Ee0J66D.js";import{s as ot}from"../chunks/B6tQqGKT.js";import{r as lt,S as Fe,A as Ie,a as Le,C as Oe,b as nt}from"../chunks/Cbdj7bjx.js";import{F as it,C as dt}from"../chunks/Mj2mMpot.js";import{A as vt}from"../chunks/1TIcjB_i.js";const ct=!1,ut=async()=>({}),Yt=Object.freeze(Object.defineProperty({__proto__:null,load:ut,prerender:ct},Symbol.toStringTag,{value:"Module"}));var _t=i("<!> <!>",1),ft=i('<div class="flex items-center space-x-2"><!> <!></div>'),pt=i('<div class="space-y-2"></div>'),mt=i("<!> <!>",1),$t=i("<!> <!>",1),gt=i('<!> <span class="font-medium"> </span>',1),ht=i("<!> 選択中",1),xt=i("<!> 利用不可",1),bt=i('<div><!> <div class="flex-1 min-w-0"><!> <p class="text-xs text-muted-foreground truncate mt-1"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div>'),yt=i('<div class="pt-4 border-t"><p class="text-sm text-muted-foreground">選択された作業ディレクトリ: <span class="font-medium text-foreground"> </span></p></div>'),Pt=i('<div class="space-y-4"><div class="flex items-center space-x-2 pb-2 border-b"><!> <!></div> <div class="space-y-2"></div> <!></div>'),kt=i("<!> <!>",1);function Ct(ye,de){Re(de,!0);let o=Be(de,"selectedDirectories",31,()=>Ae([])),L=Be(de,"onSelectionChange",3,()=>{}),b=I(Ae([])),V=I(!0),ve=I(null),w=ne(()=>e(b).length>0&&e(b).every(v=>o().includes(v.path))),pe=ne(()=>o().length>0&&o().length<e(b).length);We(async()=>{try{C(b,await lt.list(),!0),C(V,!1)}catch(v){C(ve,v instanceof Error?v.message:"作業ディレクトリの取得に失敗しました",!0),C(V,!1)}});function me(v){o().includes(v)?o(o().filter(ee=>ee!==v)):o([...o(),v]),L()(o())}function G(){e(w)?o([]):o(e(b).map(v=>v.path)),L()(o())}function Pe(v){return!0}Je(ye,{children:(v,ee)=>{var $e=kt(),ge=u($e);Ne(ge,{children:(j,q)=>{var O=_t(),H=u(O);Ve(H,{children:(K,y)=>{d();var f=g("作業ディレクトリ選択");t(K,f)},$$slots:{default:!0}});var te=a(H,2);He(te,{children:(K,y)=>{d();var f=g("タスクを実行する作業ディレクトリを選択してください");t(K,f)},$$slots:{default:!0}}),t(j,O)},$$slots:{default:!0}});var E=a(ge,2);Ge(E,{children:(j,q)=>{var O=fe(),H=u(O);{var te=y=>{var f=pt();De(f,20,()=>Array(3),Me,(Q,he)=>{var h=ft(),_=n(h);Fe(_,{class:"h-4 w-4"});var S=a(_,2);Fe(S,{class:"h-4 flex-1"}),s(h),t(Q,h)}),s(f),t(y,f)},K=y=>{var f=fe(),Q=u(f);{var he=_=>{Ie(_,{variant:"destructive",children:(S,R)=>{var A=mt(),P=u(A);je(P,{class:"h-4 w-4"});var p=a(P,2);Le(p,{children:(m,U)=>{d();var D=g();J(()=>N(D,e(ve))),t(m,D)},$$slots:{default:!0}}),t(S,A)},$$slots:{default:!0}})},h=_=>{var S=fe(),R=u(S);{var A=p=>{Ie(p,{children:(m,U)=>{var D=$t(),W=u(D);je(W,{class:"h-4 w-4"});var X=a(W,2);Le(X,{children:(Y,ce)=>{d();var M=g("作業ディレクトリが設定されていません。backend/config/repositories.jsonを確認してください。");t(Y,M)},$$slots:{default:!0}}),t(m,D)},$$slots:{default:!0}})},P=p=>{var m=Pt(),U=n(m),D=n(U);Oe(D,{get checked(){return e(w)},get indeterminate(){return e(pe)},onCheckedChange:G});var W=a(D,2);ie(W,{class:"text-sm font-medium cursor-pointer",onclick:G,children:(M,$)=>{d();var x=g();J(()=>N(x,`すべて選択 (${o().length??""}/${e(b).length??""})`)),t(M,x)},$$slots:{default:!0}}),s(U);var X=a(U,2);De(X,21,()=>e(b),Me,(M,$)=>{var x=bt();const z=ne(()=>o().includes(e($).path)),r=ne(()=>Pe(e($)));var T=n(x);{let c=ne(()=>!e(r));Oe(T,{get checked(){return e(z)},get disabled(){return e(c)},onCheckedChange:()=>me(e($).path)})}var l=a(T,2),re=n(l);ie(re,{class:"flex items-center gap-2 cursor-pointer",onclick:()=>e(r)&&me(e($).path),children:(c,se)=>{var oe=gt(),k=u(oe);it(k,{class:"h-4 w-4 text-muted-foreground flex-shrink-0"});var B=a(k,2),Ce=n(B,!0);s(B),J(()=>N(Ce,e($).name)),t(c,oe)},$$slots:{default:!0}});var Z=a(re,2),xe=n(Z,!0);s(Z),s(l);var be=a(l,2),ae=n(be);{var ue=c=>{Ee(c,{variant:"secondary",class:"text-xs",children:(se,oe)=>{var k=ht(),B=u(k);Ye(B,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(ae,c=>{e(z)&&c(ue)})}var _e=a(ae,2);{var ke=c=>{Ee(c,{variant:"destructive",class:"text-xs",children:(se,oe)=>{var k=xt(),B=u(k);dt(B,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(_e,c=>{e(r)||c(ke)})}s(be),s(x),J(()=>{ot(x,1,`flex items-center space-x-3 p-3 rounded-lg border transition-colors ${e(z)?"bg-muted/50 border-primary/20":"hover:bg-muted/30"}`),N(xe,e($).path)}),t(M,x)}),s(X);var Y=a(X,2);{var ce=M=>{var $=yt(),x=n($),z=a(n(x)),r=n(z);s(z),s(x),s($),J(()=>N(r,`${o().length??""}個`)),t(M,$)};le(Y,M=>{o().length>0&&M(ce)})}s(m),t(p,m)};le(R,p=>{e(b).length===0?p(A):p(P,!1)},!0)}t(_,S)};le(Q,_=>{e(ve)?_(he):_(h,!1)},!0)}t(y,f)};le(H,y=>{e(V)?y(te):y(K,!1)})}t(j,O)},$$slots:{default:!0}}),t(v,$e)},$$slots:{default:!0}}),ze()}var wt=i("<!> タスク一覧に戻る",1),St=i("<!> <!>",1),At=i("<!> <!>",1),Dt=i("<!> ",1),Mt=i('<form class="space-y-6"><div class="space-y-2"><!> <!></div> <!> <div class="grid grid-cols-2 gap-4"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div></div> <div class="space-y-2"><!> <!></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Tt=i("<!> <!>",1),Et=i('<div class="container mx-auto p-6 max-w-2xl"><div class="mb-6"><!> <h1 class="text-3xl font-bold">新規タスク作成</h1></div> <!></div>');function Zt(ye,de){Re(de,!0);let o=I(""),L=I(Ae([])),b=I(30),V=I(3e5),ve=!0,w=I("allow");const pe=[{value:"ask",label:"確認する (ask)"},{value:"allow",label:"すべて許可 (allow)"},{value:"deny",label:"すべて拒否 (deny)"},{value:"bypassPermissions",label:"権限バイパス (bypassPermissions)"},{value:"acceptEdits",label:"編集を受け入れる (acceptEdits)"},{value:"plan",label:"計画モード (plan)"}],me=ne(()=>pe.find(E=>E.value===e(w))?.label??"権限モードを選択");let G=I(!1);async function Pe(E){if(E.preventDefault(),!e(o).trim()){alert("指示内容を入力してください");return}if(e(L).length===0){alert("作業ディレクトリを選択してください");return}C(G,!0);const j={instruction:e(o).trim(),context:{workingDirectory:e(L)[0],files:[]},options:{timeout:e(V),async:ve,sdk:{maxTurns:e(b),permissionMode:Array.isArray(e(w))?e(w)[0]:e(w)}}};console.log("Creating task with request:",JSON.stringify(j,null,2)),console.log("Permission mode type:",typeof e(w),"value:",e(w));try{(await st.createTask(j)).data&&we("/tasks")}catch(q){console.error("Failed to create task:",q),alert("タスクの作成に失敗しました")}finally{C(G,!1)}}var v=Et(),ee=n(v),$e=n(ee);Se($e,{variant:"ghost",onclick:()=>we("/tasks"),class:"gap-2 mb-4",children:(E,j)=>{var q=wt(),O=u(q);vt(O,{class:"h-4 w-4"}),d(),t(E,q)},$$slots:{default:!0}}),d(2),s(ee);var ge=a(ee,2);F(ge,()=>Je,(E,j)=>{j(E,{children:(q,O)=>{var H=Tt(),te=u(H);F(te,()=>Ne,(y,f)=>{f(y,{children:(Q,he)=>{var h=St(),_=u(h);F(_,()=>Ve,(R,A)=>{A(R,{children:(P,p)=>{d();var m=g("タスク設定");t(P,m)},$$slots:{default:!0}})});var S=a(_,2);F(S,()=>He,(R,A)=>{A(R,{children:(P,p)=>{d();var m=g("実行したいタスクの内容を入力してください");t(P,m)},$$slots:{default:!0}})}),t(Q,h)},$$slots:{default:!0}})});var K=a(te,2);F(K,()=>Ge,(y,f)=>{f(y,{children:(Q,he)=>{var h=Mt(),_=n(h),S=n(_);ie(S,{for:"instruction",class:"required",children:(r,T)=>{d();var l=g("指示内容");t(r,l)},$$slots:{default:!0}});var R=a(S,2);at(R,{id:"instruction",placeholder:"例: README.mdファイルを作成してください",rows:4,required:!0,class:"resize-none",get value(){return e(o)},set value(r){C(o,r,!0)}}),s(_);var A=a(_,2);Ct(A,{onSelectionChange:r=>{C(L,r,!0)},get selectedDirectories(){return e(L)},set selectedDirectories(r){C(L,r,!0)}});var P=a(A,2),p=n(P),m=n(p);ie(m,{for:"maxTurns",children:(r,T)=>{d();var l=g("最大ターン数");t(r,l)},$$slots:{default:!0}});var U=a(m,2);qe(U,{id:"maxTurns",type:"number",min:1,max:100,get value(){return e(b)},set value(r){C(b,r,!0)}}),s(p);var D=a(p,2),W=n(D);ie(W,{for:"timeout",children:(r,T)=>{d();var l=g("タイムアウト (ms)");t(r,l)},$$slots:{default:!0}});var X=a(W,2);qe(X,{id:"timeout",type:"number",min:1e3,step:1e3,get value(){return e(V)},set value(r){C(V,r,!0)}}),s(D),s(P);var Y=a(P,2),ce=n(Y);ie(ce,{for:"permissionMode",children:(r,T)=>{d();var l=g("権限モード");t(r,l)},$$slots:{default:!0}});var M=a(ce,2);F(M,()=>Ze,(r,T)=>{T(r,{type:"single",get value(){return e(w)},set value(l){C(w,l,!0)},children:(l,re)=>{var Z=At(),xe=u(Z);F(xe,()=>et,(ae,ue)=>{ue(ae,{id:"permissionMode",children:(_e,ke)=>{d();var c=g();J(()=>N(c,e(me))),t(_e,c)},$$slots:{default:!0}})});var be=a(xe,2);F(be,()=>tt,(ae,ue)=>{ue(ae,{children:(_e,ke)=>{var c=fe(),se=u(c);De(se,17,()=>pe,Me,(oe,k)=>{var B=fe(),Ce=u(B);F(Ce,()=>rt,(Ke,Qe)=>{Qe(Ke,{get value(){return e(k).value},get label(){return e(k).label},children:(Ue,jt)=>{d();var Te=g();J(()=>N(Te,e(k).label)),t(Ue,Te)},$$slots:{default:!0}})}),t(oe,B)}),t(_e,c)},$$slots:{default:!0}})}),t(l,Z)},$$slots:{default:!0}})}),s(Y);var $=a(Y,2),x=n($);Se(x,{type:"submit",get disabled(){return e(G)},class:"gap-2",children:(r,T)=>{var l=Dt(),re=u(l);nt(re,{class:"h-4 w-4"});var Z=a(re);J(()=>N(Z,` ${e(G)?"作成中...":"タスクを作成"}`)),t(r,l)},$$slots:{default:!0}});var z=a(x,2);Se(z,{type:"button",variant:"outline",onclick:()=>we("/tasks"),children:(r,T)=>{d();var l=g("キャンセル");t(r,l)},$$slots:{default:!0}}),s($),s(h),Xe("submit",h,Pe),t(Q,h)},$$slots:{default:!0}})}),t(q,H)},$$slots:{default:!0}})}),s(v),t(ye,v),ze()}export{Zt as component,Yt as universal};
