import"../chunks/NZTpNUN0.js";import{p as Re,m as Ae,k as I,l as C,f as i,e as u,C as d,B as g,a as t,s as a,d as fe,g as e,c as n,r as s,t as J,h as ne,b as ze}from"../chunks/hUgNfGIw.js";import{o as We,s as N}from"../chunks/Cw6sL175.js";import{a as De,i as Me}from"../chunks/C8ON3q3r.js";import{c as F}from"../chunks/BGAF9F00.js";import{e as Xe}from"../chunks/DuGWCAUg.js";import{g as we}from"../chunks/CIJt74Qn.js";import{B as Se}from"../chunks/Hn86ru-6.js";import{a as Je,C as Ne,B as Be}from"../chunks/IsgJQnF1.js";import{C as Ge}from"../chunks/Ch7_jghy.js";import{C as He,a as Ke}from"../chunks/bulbDurL.js";import{I as Ee}from"../chunks/CrnEy6TL.js";import{L as ie,T as Ye}from"../chunks/WXVq1anh.js";import{R as Ze,S as et,a as tt,b as rt}from"../chunks/BMLIE5Wk.js";import{t as at}from"../chunks/BRMFLji0.js";import{p as qe,i as le}from"../chunks/297qlWCs.js";import{s as st}from"../chunks/emurSIzu.js";import{r as ot,S as je,A as Fe,a as Ie,C as Le,b as lt}from"../chunks/Bgs6mnWP.js";import{C as Oe,a as nt}from"../chunks/YFyzAVMW.js";import{F as it,C as dt}from"../chunks/ClF-o79z.js";import{A as vt}from"../chunks/BMAjPwDN.js";const ct=!1,ut=async()=>({}),tr=Object.freeze(Object.defineProperty({__proto__:null,load:ut,prerender:ct},Symbol.toStringTag,{value:"Module"}));var _t=i("<!> <!>",1),ft=i('<div class="flex items-center space-x-2"><!> <!></div>'),mt=i('<div class="space-y-2"></div>'),pt=i("<!> <!>",1),$t=i("<!> <!>",1),gt=i('<!> <span class="font-medium"> </span>',1),ht=i("<!> 選択中",1),xt=i("<!> 利用不可",1),bt=i('<div><!> <div class="flex-1 min-w-0"><!> <p class="text-xs text-muted-foreground truncate mt-1"> </p></div> <div class="flex items-center gap-2"><!> <!></div></div>'),yt=i('<div class="pt-4 border-t"><p class="text-sm text-muted-foreground">選択された作業ディレクトリ: <span class="font-medium text-foreground"> </span></p></div>'),Pt=i('<div class="space-y-4"><div class="flex items-center space-x-2 pb-2 border-b"><!> <!></div> <div class="space-y-2"></div> <!></div>'),kt=i("<!> <!>",1);function Ct(ye,de){Re(de,!0);let o=qe(de,"selectedDirectories",31,()=>Ae([])),L=qe(de,"onSelectionChange",3,()=>{}),b=I(Ae([])),G=I(!0),ve=I(null),w=ne(()=>e(b).length>0&&e(b).every(v=>o().includes(v.path))),me=ne(()=>o().length>0&&o().length<e(b).length);We(async()=>{try{C(b,await ot.list(),!0),C(G,!1)}catch(v){C(ve,v instanceof Error?v.message:"作業ディレクトリの取得に失敗しました",!0),C(G,!1)}});function pe(v){o().includes(v)?o(o().filter(ee=>ee!==v)):o([...o(),v]),L()(o())}function H(){e(w)?o([]):o(e(b).map(v=>v.path)),L()(o())}function Pe(v){return!0}Je(ye,{children:(v,ee)=>{var $e=kt(),ge=u($e);He(ge,{children:(E,q)=>{var O=_t(),K=u(O);Ke(K,{children:(Q,y)=>{d();var f=g("作業ディレクトリ選択");t(Q,f)},$$slots:{default:!0}});var te=a(K,2);Ge(te,{children:(Q,y)=>{d();var f=g("タスクを実行する作業ディレクトリを選択してください");t(Q,f)},$$slots:{default:!0}}),t(E,O)},$$slots:{default:!0}});var B=a(ge,2);Ne(B,{children:(E,q)=>{var O=fe(),K=u(O);{var te=y=>{var f=mt();De(f,20,()=>Array(3),Me,(U,he)=>{var h=ft(),_=n(h);je(_,{class:"h-4 w-4"});var S=a(_,2);je(S,{class:"h-4 flex-1"}),s(h),t(U,h)}),s(f),t(y,f)},Q=y=>{var f=fe(),U=u(f);{var he=_=>{Fe(_,{variant:"destructive",children:(S,R)=>{var A=pt(),P=u(A);Oe(P,{class:"h-4 w-4"});var m=a(P,2);Ie(m,{children:(p,V)=>{d();var D=g();J(()=>N(D,e(ve))),t(p,D)},$$slots:{default:!0}}),t(S,A)},$$slots:{default:!0}})},h=_=>{var S=fe(),R=u(S);{var A=m=>{Fe(m,{children:(p,V)=>{var D=$t(),W=u(D);Oe(W,{class:"h-4 w-4"});var X=a(W,2);Ie(X,{children:(Y,ce)=>{d();var M=g("作業ディレクトリが設定されていません。backend/config/repositories.jsonを確認してください。");t(Y,M)},$$slots:{default:!0}}),t(p,D)},$$slots:{default:!0}})},P=m=>{var p=Pt(),V=n(p),D=n(V);Le(D,{get checked(){return e(w)},get indeterminate(){return e(me)},onCheckedChange:H});var W=a(D,2);ie(W,{class:"text-sm font-medium cursor-pointer",onclick:H,children:(M,$)=>{d();var x=g();J(()=>N(x,`すべて選択 (${o().length??""}/${e(b).length??""})`)),t(M,x)},$$slots:{default:!0}}),s(V);var X=a(V,2);De(X,21,()=>e(b),Me,(M,$)=>{var x=bt();const z=ne(()=>o().includes(e($).path)),r=ne(()=>Pe(e($)));var T=n(x);{let c=ne(()=>!e(r));Le(T,{get checked(){return e(z)},get disabled(){return e(c)},onCheckedChange:()=>pe(e($).path)})}var l=a(T,2),re=n(l);ie(re,{class:"flex items-center gap-2 cursor-pointer",onclick:()=>e(r)&&pe(e($).path),children:(c,se)=>{var oe=gt(),k=u(oe);it(k,{class:"h-4 w-4 text-muted-foreground flex-shrink-0"});var j=a(k,2),Ce=n(j,!0);s(j),J(()=>N(Ce,e($).name)),t(c,oe)},$$slots:{default:!0}});var Z=a(re,2),xe=n(Z,!0);s(Z),s(l);var be=a(l,2),ae=n(be);{var ue=c=>{Be(c,{variant:"secondary",class:"text-xs",children:(se,oe)=>{var k=ht(),j=u(k);nt(j,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(ae,c=>{e(z)&&c(ue)})}var _e=a(ae,2);{var ke=c=>{Be(c,{variant:"destructive",class:"text-xs",children:(se,oe)=>{var k=xt(),j=u(k);dt(j,{class:"h-3 w-3 mr-1"}),d(),t(se,k)},$$slots:{default:!0}})};le(_e,c=>{e(r)||c(ke)})}s(be),s(x),J(()=>{st(x,1,`flex items-center space-x-3 p-3 rounded-lg border transition-colors ${e(z)?"bg-muted/50 border-primary/20":"hover:bg-muted/30"}`),N(xe,e($).path)}),t(M,x)}),s(X);var Y=a(X,2);{var ce=M=>{var $=yt(),x=n($),z=a(n(x)),r=n(z);s(z),s(x),s($),J(()=>N(r,`${o().length??""}個`)),t(M,$)};le(Y,M=>{o().length>0&&M(ce)})}s(p),t(m,p)};le(R,m=>{e(b).length===0?m(A):m(P,!1)},!0)}t(_,S)};le(U,_=>{e(ve)?_(he):_(h,!1)},!0)}t(y,f)};le(K,y=>{e(G)?y(te):y(Q,!1)})}t(E,O)},$$slots:{default:!0}}),t(v,$e)},$$slots:{default:!0}}),ze()}var wt=i("<!> タスク一覧に戻る",1),St=i("<!> <!>",1),At=i("<!> <!>",1),Dt=i("<!> ",1),Mt=i('<form class="space-y-6"><div class="space-y-2"><!> <!></div> <!> <div class="grid grid-cols-2 gap-4"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div></div> <div class="space-y-2"><!> <!></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Tt=i("<!> <!>",1),Bt=i('<div class="container mx-auto p-6 max-w-2xl"><div class="mb-6"><!> <h1 class="text-3xl font-bold">新規タスク作成</h1></div> <!></div>');function rr(ye,de){Re(de,!0);let o=I(""),L=I(Ae([])),b=I(30),G=I(3e5),ve=!0,w=I("allow");const me=[{value:"ask",label:"確認する (ask)"},{value:"allow",label:"すべて許可 (allow)"},{value:"deny",label:"すべて拒否 (deny)"},{value:"bypassPermissions",label:"権限バイパス (bypassPermissions)"},{value:"acceptEdits",label:"編集を受け入れる (acceptEdits)"},{value:"plan",label:"計画モード (plan)"}],pe=ne(()=>me.find(B=>B.value===e(w))?.label??"権限モードを選択");let H=I(!1);async function Pe(B){if(B.preventDefault(),!e(o).trim()){alert("指示内容を入力してください");return}if(e(L).length===0){alert("作業ディレクトリを選択してください");return}C(H,!0);const E={instruction:e(o).trim(),context:{workingDirectory:e(L)[0],files:[]},options:{timeout:e(G),async:ve,sdk:{maxTurns:e(b),permissionMode:Array.isArray(e(w))?e(w)[0]:e(w)}}};console.log("Creating task with request:",JSON.stringify(E,null,2)),console.log("Permission mode type:",typeof e(w),"value:",e(w));try{(await at.createTask(E)).data&&we("/tasks")}catch(q){console.error("Failed to create task:",q),alert("タスクの作成に失敗しました")}finally{C(H,!1)}}var v=Bt(),ee=n(v),$e=n(ee);Se($e,{variant:"ghost",onclick:()=>we("/tasks"),class:"gap-2 mb-4",children:(B,E)=>{var q=wt(),O=u(q);vt(O,{class:"h-4 w-4"}),d(),t(B,q)},$$slots:{default:!0}}),d(2),s(ee);var ge=a(ee,2);F(ge,()=>Je,(B,E)=>{E(B,{children:(q,O)=>{var K=Tt(),te=u(K);F(te,()=>He,(y,f)=>{f(y,{children:(U,he)=>{var h=St(),_=u(h);F(_,()=>Ke,(R,A)=>{A(R,{children:(P,m)=>{d();var p=g("タスク設定");t(P,p)},$$slots:{default:!0}})});var S=a(_,2);F(S,()=>Ge,(R,A)=>{A(R,{children:(P,m)=>{d();var p=g("実行したいタスクの内容を入力してください");t(P,p)},$$slots:{default:!0}})}),t(U,h)},$$slots:{default:!0}})});var Q=a(te,2);F(Q,()=>Ne,(y,f)=>{f(y,{children:(U,he)=>{var h=Mt(),_=n(h),S=n(_);ie(S,{for:"instruction",class:"required",children:(r,T)=>{d();var l=g("指示内容");t(r,l)},$$slots:{default:!0}});var R=a(S,2);Ye(R,{id:"instruction",placeholder:"例: README.mdファイルを作成してください",rows:4,required:!0,class:"resize-none",get value(){return e(o)},set value(r){C(o,r,!0)}}),s(_);var A=a(_,2);Ct(A,{onSelectionChange:r=>{C(L,r,!0)},get selectedDirectories(){return e(L)},set selectedDirectories(r){C(L,r,!0)}});var P=a(A,2),m=n(P),p=n(m);ie(p,{for:"maxTurns",children:(r,T)=>{d();var l=g("最大ターン数");t(r,l)},$$slots:{default:!0}});var V=a(p,2);Ee(V,{id:"maxTurns",type:"number",min:1,max:100,get value(){return e(b)},set value(r){C(b,r,!0)}}),s(m);var D=a(m,2),W=n(D);ie(W,{for:"timeout",children:(r,T)=>{d();var l=g("タイムアウト (ms)");t(r,l)},$$slots:{default:!0}});var X=a(W,2);Ee(X,{id:"timeout",type:"number",min:1e3,step:1e3,get value(){return e(G)},set value(r){C(G,r,!0)}}),s(D),s(P);var Y=a(P,2),ce=n(Y);ie(ce,{for:"permissionMode",children:(r,T)=>{d();var l=g("権限モード");t(r,l)},$$slots:{default:!0}});var M=a(ce,2);F(M,()=>Ze,(r,T)=>{T(r,{type:"single",get value(){return e(w)},set value(l){C(w,l,!0)},children:(l,re)=>{var Z=At(),xe=u(Z);F(xe,()=>et,(ae,ue)=>{ue(ae,{id:"permissionMode",children:(_e,ke)=>{d();var c=g();J(()=>N(c,e(pe))),t(_e,c)},$$slots:{default:!0}})});var be=a(xe,2);F(be,()=>tt,(ae,ue)=>{ue(ae,{children:(_e,ke)=>{var c=fe(),se=u(c);De(se,17,()=>me,Me,(oe,k)=>{var j=fe(),Ce=u(j);F(Ce,()=>rt,(Qe,Ue)=>{Ue(Qe,{get value(){return e(k).value},get label(){return e(k).label},children:(Ve,Et)=>{d();var Te=g();J(()=>N(Te,e(k).label)),t(Ve,Te)},$$slots:{default:!0}})}),t(oe,j)}),t(_e,c)},$$slots:{default:!0}})}),t(l,Z)},$$slots:{default:!0}})}),s(Y);var $=a(Y,2),x=n($);Se(x,{type:"submit",get disabled(){return e(H)},class:"gap-2",children:(r,T)=>{var l=Dt(),re=u(l);lt(re,{class:"h-4 w-4"});var Z=a(re);J(()=>N(Z,` ${e(H)?"作成中...":"タスクを作成"}`)),t(r,l)},$$slots:{default:!0}});var z=a(x,2);Se(z,{type:"button",variant:"outline",onclick:()=>we("/tasks"),children:(r,T)=>{d();var l=g("キャンセル");t(r,l)},$$slots:{default:!0}}),s($),s(h),Xe("submit",h,Pe),t(U,h)},$$slots:{default:!0}})}),t(q,K)},$$slots:{default:!0}})}),s(v),t(ye,v),ze()}export{rr as component,tr as universal};
