import{t as Zt}from"../chunks/CuT5Jeyz.js";import"../chunks/NZTpNUN0.js";import{d as M,e as m,a,V as k,h as e,i as D,g as nt,I as te,aq as _t,p as Z,b as tt,f as _,c as d,n as bt,r as i,s as w,t as K,b8 as ee,y as at,x as ut}from"../chunks/DsgVtOPg.js";import{a as ot,s as Q}from"../chunks/2BTfzV6r.js";import{l as Bt,s as ct,p as y,i as q,r as it}from"../chunks/8Ee0J66D.js";import{I as zt,s as Et,e as qt,i as Gt}from"../chunks/Ctyd3DqP.js";import{c as B}from"../chunks/DYtQPdT-.js";import{B as gt}from"../chunks/Dgibhu4a.js";import{B as St,C as re,a as se,b as ae,c as ne}from"../chunks/B6-b1C0K.js";import{C as oe}from"../chunks/DC4utYBl.js";import"../chunks/eVFC9t49.js";import{d as ie}from"../chunks/CDdHQTXV.js";import{a as kt,d as jt}from"../chunks/B6tQqGKT.js";import{a as xt,h as wt,l as yt,n as le,c as de,w as Ft,d as A,b as Ct,m as Pt}from"../chunks/C8jSZUu-.js";import{C as ce,S as ve,d as ue,n as Rt}from"../chunks/CSZN-l4M.js";import{a as he,O as fe,P as pe,C as me}from"../chunks/BVP7w1WO.js";import{C as ge}from"../chunks/D-drercE.js";import{G as Ht}from"../chunks/4jdneJbX.js";import"../chunks/BVfiLATO.js";import{f as _e,j as be}from"../chunks/C74-udT0.js";import{R as ke}from"../chunks/CE983rsk.js";function xe(u,t){const s=Bt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["circle",{cx:"12",cy:"12",r:"10"}]];zt(u,ct({name:"circle"},()=>s,{get iconNode(){return n},children:(o,v)=>{var c=M(),h=m(c);Et(h,t,"default",{}),a(o,c)},$$slots:{default:!0}}))}function we(u,t){const s=Bt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const n=[["path",{d:"M3 12h.01"}],["path",{d:"M3 18h.01"}],["path",{d:"M3 6h.01"}],["path",{d:"M8 12h13"}],["path",{d:"M8 18h13"}],["path",{d:"M8 6h13"}]];zt(u,ct({name:"list"},()=>s,{get iconNode(){return n},children:(o,v)=>{var c=M(),h=m(c);Et(h,t,"default",{}),a(o,c)},$$slots:{default:!0}}))}const Ot=de({component:"collapsible",parts:["root","content","trigger"]}),Mt=new ce("Collapsible.Root");class Nt{static create(t){return Mt.set(new Nt(t))}opts;attachment;#t=nt(null);get contentNode(){return e(this.#t)}set contentNode(t){D(this.#t,t,!0)}#e=nt(void 0);get contentId(){return e(this.#e)}set contentId(t){D(this.#e,t,!0)}constructor(t){this.opts=t,this.toggleOpen=this.toggleOpen.bind(this),this.attachment=xt(this.opts.ref),new fe({ref:A.with(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}})}toggleOpen(){this.opts.open.current=!this.opts.open.current}#r=k(()=>({id:this.opts.id.current,"data-state":yt(this.opts.open.current),"data-disabled":wt(this.opts.disabled.current),[Ot.root]:"",...this.attachment}));get props(){return e(this.#r)}set props(t){D(this.#r,t)}}class $t{static create(t){return new $t(t,Mt.get())}opts;root;attachment;#t=k(()=>this.opts.forceMount.current||this.root.opts.open.current);get present(){return e(this.#t)}set present(t){D(this.#t,t)}#e;#r=nt(!1);#s=nt(0);#a=nt(0);constructor(t,s){this.opts=t,this.root=s,D(this.#r,s.opts.open.current,!0),this.root.contentId=this.opts.id.current,this.attachment=xt(this.opts.ref,n=>this.root.contentNode=n),Ft.pre(()=>this.opts.id.current,n=>{this.root.contentId=n}),te(()=>{const n=requestAnimationFrame(()=>{D(this.#r,!1)});return()=>{cancelAnimationFrame(n)}}),Ft([()=>this.opts.ref.current,()=>this.present],([n])=>{n&&he(()=>{if(!this.opts.ref.current)return;this.#e=this.#e||{transitionDuration:n.style.transitionDuration,animationName:n.style.animationName},n.style.transitionDuration="0s",n.style.animationName="none";const o=n.getBoundingClientRect();if(D(this.#a,o.height,!0),D(this.#s,o.width,!0),!e(this.#r)){const{animationName:v,transitionDuration:c}=this.#e;n.style.transitionDuration=c,n.style.animationName=v}})})}#n=k(()=>({open:this.root.opts.open.current}));get snippetProps(){return e(this.#n)}set snippetProps(t){D(this.#n,t)}#o=k(()=>({id:this.opts.id.current,style:{"--bits-collapsible-content-height":e(this.#a)?`${e(this.#a)}px`:void 0,"--bits-collapsible-content-width":e(this.#s)?`${e(this.#s)}px`:void 0},"data-state":yt(this.root.opts.open.current),"data-disabled":wt(this.root.opts.disabled.current),[Ot.content]:"",...this.attachment}));get props(){return e(this.#o)}set props(t){D(this.#o,t)}}class It{static create(t){return new It(t,Mt.get())}opts;root;attachment;#t=k(()=>this.opts.disabled.current||this.root.opts.disabled.current);constructor(t,s){this.opts=t,this.root=s,this.attachment=xt(this.opts.ref),this.onclick=this.onclick.bind(this),this.onkeydown=this.onkeydown.bind(this)}onclick(t){if(!e(this.#t)){if(t.button!==0)return t.preventDefault();this.root.toggleOpen()}}onkeydown(t){e(this.#t)||(t.key===ve||t.key===ue)&&(t.preventDefault(),this.root.toggleOpen())}#e=k(()=>({id:this.opts.id.current,type:"button",disabled:e(this.#t),"aria-controls":this.root.contentId,"aria-expanded":le(this.root.opts.open.current),"data-state":yt(this.root.opts.open.current),"data-disabled":wt(e(this.#t)),[Ot.trigger]:"",onclick:this.onclick,onkeydown:this.onkeydown,...this.attachment}));get props(){return e(this.#e)}set props(t){D(this.#e,t)}}var ye=_("<div><!></div>");function Ce(u,t){const s=_t();Z(t,!0);let n=y(t,"id",19,()=>Ct(s)),o=y(t,"ref",15,null),v=y(t,"open",15,!1),c=y(t,"disabled",3,!1),h=y(t,"onOpenChange",3,Rt),g=y(t,"onOpenChangeComplete",3,Rt),C=it(t,["$$slots","$$events","$$legacy","children","child","id","ref","open","disabled","onOpenChange","onOpenChangeComplete"]);const z=Nt.create({open:A.with(()=>v(),r=>{v(r),h()(r)}),disabled:A.with(()=>c()),id:A.with(()=>n()),ref:A.with(()=>o(),r=>o(r)),onOpenChangeComplete:A.with(()=>g())}),x=k(()=>Pt(C,z.props));var P=M(),f=m(P);{var b=r=>{var l=M(),p=m(l);ot(p,()=>t.child,()=>({props:e(x)})),a(r,l)},I=r=>{var l=ye();kt(l,()=>({...e(x)}));var p=d(l);ot(p,()=>t.children??bt),i(l),a(r,l)};q(f,r=>{t.child?r(b):r(I,!1)})}a(u,P),tt()}var Pe=_("<div><!></div>");function Oe(u,t){const s=_t();Z(t,!0);let n=y(t,"ref",15,null),o=y(t,"forceMount",3,!1),v=y(t,"id",19,()=>Ct(s)),c=it(t,["$$slots","$$events","$$legacy","child","ref","forceMount","children","id"]);const h=$t.create({id:A.with(()=>v()),forceMount:A.with(()=>o()),ref:A.with(()=>n(),g=>n(g))});pe(u,{forceMount:!0,get open(){return h.present},get ref(){return h.opts.ref},presence:(C,z)=>{let x=()=>z?.().present;var P=M();const f=k(()=>Pt(c,h.props,{hidden:o()?void 0:!x()}));var b=m(P);{var I=l=>{var p=M(),S=m(p);{let j=k(()=>({...h.snippetProps,props:e(f)}));ot(S,()=>t.child,()=>e(j))}a(l,p)},r=l=>{var p=Pe();kt(p,()=>({...e(f)}));var S=d(p);ot(S,()=>t.children??bt),i(p),a(l,p)};q(b,l=>{t.child?l(I):l(r,!1)})}a(C,P)},$$slots:{presence:!0}}),tt()}var Me=_("<button><!></button>");function Ne(u,t){const s=_t();Z(t,!0);let n=y(t,"ref",15,null),o=y(t,"id",19,()=>Ct(s)),v=y(t,"disabled",3,!1),c=it(t,["$$slots","$$events","$$legacy","children","child","ref","id","disabled"]);const h=It.create({id:A.with(()=>o()),ref:A.with(()=>n(),f=>n(f)),disabled:A.with(()=>v())}),g=k(()=>Pt(c,h.props));var C=M(),z=m(C);{var x=f=>{var b=M(),I=m(b);ot(I,()=>t.child,()=>({props:e(g)})),a(f,b)},P=f=>{var b=Me();kt(b,()=>({...e(g)}));var I=d(b);ot(I,()=>t.children??bt),i(b),a(f,b)};q(z,f=>{t.child?f(x):f(P,!1)})}a(u,C),tt()}function $e(u,t){Z(t,!0);let s=y(t,"ref",15,null),n=y(t,"open",15,!1),o=it(t,["$$slots","$$events","$$legacy","ref","open"]);var v=M(),c=m(v);B(c,()=>Ce,(h,g)=>{g(h,ct({"data-slot":"collapsible"},()=>o,{get ref(){return s()},set ref(C){s(C)},get open(){return n()},set open(C){n(C)}}))}),a(u,v),tt()}function Ie(u,t){Z(t,!0);let s=y(t,"ref",15,null),n=it(t,["$$slots","$$events","$$legacy","ref"]);var o=M(),v=m(o);B(v,()=>Ne,(c,h)=>{h(c,ct({"data-slot":"collapsible-trigger"},()=>n,{get ref(){return s()},set ref(g){s(g)}}))}),a(u,o),tt()}function Te(u,t){Z(t,!0);let s=y(t,"ref",15,null),n=it(t,["$$slots","$$events","$$legacy","ref"]);var o=M(),v=m(o);B(v,()=>Oe,(c,h)=>{h(c,ct({"data-slot":"collapsible-content"},()=>n,{get ref(){return s()},set ref(g){s(g)}}))}),a(u,o),tt()}const De=async()=>{try{return{tasks:(await Zt.list({limit:1e3})).tasks||[]}}catch(u){return console.error("Failed to load tasks:",u),{tasks:[]}}},_r=Object.freeze(Object.defineProperty({__proto__:null,load:De},Symbol.toStringTag,{value:"Module"}));var Ae=_('<div class="absolute left-0 top-0 w-6 h-6 border-l-2 border-b-2 border-muted-foreground/30 rounded-bl-lg"></div>'),Se=(u,t,s)=>t(s.task.id||s.task.taskId),je=_('<div class="flex items-center gap-1 text-xs text-muted-foreground"><!> <span> </span></div>'),Fe=_('<div class="absolute left-0 top-6 bottom-0 w-px bg-muted-foreground/30" style="margin-left: 0.75rem;"></div>'),Re=_('<div class="relative"><!> <!></div>'),Be=_('<p class="text-sm text-muted-foreground ml-6"> </p>'),ze=_('<div class="mt-3 space-y-3 relative"><!></div>'),Ee=_('<div class="flex items-start gap-2"><!> <button type="button" class="flex-1 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer text-left"><div class="flex items-start justify-between"><div class="flex-1 space-y-1"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span> <!></div> <p class="text-sm line-clamp-2"> </p></div></div></button></div> <!>',1),qe=(u,t,s)=>t(s.task.id||s.task.taskId),Ge=_('<div class="flex items-start gap-2"><div class="h-6 w-6 flex items-center justify-center"><!></div> <button type="button" class="flex-1 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer text-left"><div class="flex items-start justify-between"><div class="flex-1 space-y-1"><div class="flex items-center gap-2"><!> <span class="text-xs text-muted-foreground"> </span></div> <p class="text-sm line-clamp-2"> </p></div></div></button></div>'),He=_('<div class="relative"><!> <div><!></div></div>');function Lt(u,t){Z(t,!0);let s=y(t,"depth",3,0),n=k(()=>t.allTasks.filter(r=>r.continuedFrom===t.task.id||r.parentTaskId===t.task.id)),o=k(()=>({...t.task,children:e(n).map(r=>({...r,children:t.allTasks.filter(l=>l.continuedFrom===r.id||l.parentTaskId===r.id)}))})),v=nt(s()<2);function c(r){switch(r){case"completed":return"default";case"running":return"secondary";case"failed":return"destructive";case"cancelled":return"outline";default:return"secondary"}}function h(r){try{return _e(new Date(r),"MM/dd HH:mm",{locale:be})}catch{return r}}function g(r){window.location.href=`/tasks/${r}`}var C=He(),z=d(C);{var x=r=>{var l=Ae();K(()=>jt(l,`margin-left: ${(s()-1)*1.5}rem; margin-top: -0.75rem;`)),a(r,l)};q(z,r=>{s()>0&&r(x)})}var P=w(z,2),f=d(P);{var b=r=>{var l=M(),p=m(l);B(p,()=>$e,(S,j)=>{j(S,{get open(){return e(v)},set open(U){D(v,U,!0)},children:(U,G)=>{var T=Ee(),F=m(T),H=d(F);B(H,()=>Ie,(R,V)=>{V(R,{asChild:!0,children:ee,$$slots:{default:(et,W)=>{const rt=k(()=>W.builder);{let ht=k(()=>[e(rt)]);gt(et,{variant:"ghost",size:"icon",class:"h-6 w-6 p-0",get builders(){return e(ht)},children:(ft,Dt)=>{var J=M(),X=m(J);{var lt=Y=>{me(Y,{class:"h-4 w-4"})},pt=Y=>{ge(Y,{class:"h-4 w-4"})};q(X,Y=>{e(v)?Y(lt):Y(pt,!1)})}a(ft,J)},$$slots:{default:!0}})}}}})});var N=w(H,2);N.__click=[Se,g,t];var O=d(N),E=d(O),$=d(E),st=d($);{let R=k(()=>c(t.task.status));St(st,{get variant(){return e(R)},children:(V,et)=>{at();var W=ut();K(()=>Q(W,t.task.status)),a(V,W)},$$slots:{default:!0}})}var L=w(st,2),vt=d(L,!0);i(L);var Vt=w(L,2);{var Jt=R=>{var V=je(),et=d(V);Ht(et,{class:"h-3 w-3"});var W=w(et,2),rt=d(W);i(W),i(V),K(()=>Q(rt,`${e(o).children.length??""} 継続`)),a(R,V)};q(Vt,R=>{e(o).children.length>0&&R(Jt)})}i($);var Tt=w($,2),Kt=d(Tt,!0);i(Tt),i(E),i(O),i(N),i(F);var Qt=w(F,2);B(Qt,()=>Te,(R,V)=>{V(R,{children:(et,W)=>{var rt=ze(),ht=d(rt);{var ft=J=>{var X=M(),lt=m(X);qt(lt,17,()=>e(o).children,Gt,(pt,Y,Ut)=>{var mt=Re(),At=d(mt);{var Wt=dt=>{var Yt=Fe();a(dt,Yt)};q(At,dt=>{Ut<e(o).children.length-1&&dt(Wt)})}var Xt=w(At,2);{let dt=k(()=>s()+1);Lt(Xt,{get task(){return e(Y)},get allTasks(){return t.allTasks},get depth(){return e(dt)}})}i(mt),a(pt,mt)}),a(J,X)},Dt=J=>{var X=Be(),lt=d(X);i(X),K(()=>Q(lt,`さらに ${e(o).children.length??""} 件の継続タスク...`)),a(J,X)};q(ht,J=>{s()<5?J(ft):J(Dt,!1)})}i(rt),a(et,rt)},$$slots:{default:!0}})}),K(R=>{Q(vt,R),Q(Kt,t.task.instruction)},[()=>h(t.task.createdAt)]),a(U,T)},$$slots:{default:!0}})}),a(r,l)},I=r=>{var l=Ge(),p=d(l),S=d(p);xe(S,{class:"h-2 w-2 fill-current text-muted-foreground"}),i(p);var j=w(p,2);j.__click=[qe,g,t];var U=d(j),G=d(U),T=d(G),F=d(T);{let $=k(()=>c(t.task.status));St(F,{get variant(){return e($)},children:(st,L)=>{at();var vt=ut();K(()=>Q(vt,t.task.status)),a(st,vt)},$$slots:{default:!0}})}var H=w(F,2),N=d(H,!0);i(H),i(T);var O=w(T,2),E=d(O,!0);i(O),i(G),i(U),i(j),i(l),K($=>{Q(N,$),Q(E,t.task.instruction)},[()=>h(t.task.createdAt)]),a(r,l)};q(f,r=>{e(o).children&&e(o).children.length>0?r(b):r(I,!1)})}i(P),i(C),K(()=>jt(P,`margin-left: ${s()*1.5}rem;`)),a(u,C),tt()}ie(["click"]);var Le=_("<!> リスト表示",1),Ve=_("<!> 更新",1),Je=_('<div class="flex items-center gap-2"><!> <!></div> <!>',1),Ke=_('<div class="space-y-4"></div>'),Qe=_('<p class="text-center text-muted-foreground py-8">タスクがありません</p>'),Ue=_("<!> <!>",1),We=_('<div class="space-y-6"><div class="flex justify-between items-center"><div><h2 class="text-3xl font-bold tracking-tight">タスクツリー</h2> <p class="text-muted-foreground">タスクの継続関係をツリー表示</p></div> <div class="flex gap-2"><!> <!></div></div> <!></div>');function br(u,t){Z(t,!0);let s=k(()=>t.data.tasks.filter(x=>!x.continuedFrom&&!x.parentTaskId));function n(){window.location.reload()}function o(){window.location.href="/tasks"}var v=We(),c=d(v),h=w(d(c),2),g=d(h);gt(g,{variant:"outline",onclick:o,children:(x,P)=>{var f=Le(),b=m(f);we(b,{class:"mr-2 h-4 w-4"}),at(),a(x,f)},$$slots:{default:!0}});var C=w(g,2);gt(C,{variant:"outline",onclick:n,children:(x,P)=>{var f=Ve(),b=m(f);ke(b,{class:"mr-2 h-4 w-4"}),at(),a(x,f)},$$slots:{default:!0}}),i(h),i(c);var z=w(c,2);B(z,()=>ne,(x,P)=>{P(x,{children:(f,b)=>{var I=Ue(),r=m(I);B(r,()=>re,(p,S)=>{S(p,{children:(j,U)=>{var G=Je(),T=m(G),F=d(T);Ht(F,{class:"h-5 w-5"});var H=w(F,2);B(H,()=>se,(O,E)=>{E(O,{children:($,st)=>{at();var L=ut("タスク継続関係");a($,L)},$$slots:{default:!0}})}),i(T);var N=w(T,2);B(N,()=>oe,(O,E)=>{E(O,{children:($,st)=>{at();var L=ut();K(()=>Q(L,`${e(s).length??""} 件のルートタスク（全 ${t.data.tasks.length??""} 件）`)),a($,L)},$$slots:{default:!0}})}),a(j,G)},$$slots:{default:!0}})});var l=w(r,2);B(l,()=>ae,(p,S)=>{S(p,{children:(j,U)=>{var G=M(),T=m(G);{var F=N=>{var O=Ke();qt(O,21,()=>e(s),Gt,(E,$)=>{Lt(E,{get task(){return e($)},get allTasks(){return t.data.tasks}})}),i(O),a(N,O)},H=N=>{var O=Qe();a(N,O)};q(T,N=>{e(s).length>0?N(F):N(H,!1)})}a(j,G)},$$slots:{default:!0}})}),a(f,I)},$$slots:{default:!0}})}),i(v),a(u,v),tt()}export{br as component,_r as universal};
