/api/repositories:
  get:
    tags:
      - repositories
    summary: List available repositories
    operationId: listRepositories
    responses:
      '200':
        description: Repository list retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                repositories:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      path:
                        type: string
                      description:
                        type: string
                        nullable: true
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'

/api/repositories/tree:
  get:
    tags:
      - repositories
    summary: Get repository file tree
    operationId: getRepositoryTree
    parameters:
      - name: repository
        in: query
        required: true
        description: Repository path
        schema:
          type: string
      - name: path
        in: query
        required: false
        description: Subdirectory path within repository
        schema:
          type: string
      - name: showHidden
        in: query
        required: false
        description: Include hidden files
        schema:
          type: boolean
          default: false
      - name: maxDepth
        in: query
        required: false
        description: Maximum depth to traverse
        schema:
          type: integer
          minimum: 1
          maximum: 10
          default: 3
    responses:
      '200':
        description: File tree retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                tree:
                  $ref: '../components/schemas/index.yaml#/FileNode'
      '400':
        $ref: '../components/responses/index.yaml#/BadRequest'
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '404':
        $ref: '../components/responses/index.yaml#/NotFound'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'

/api/repositories/file:
  get:
    tags:
      - repositories
    summary: Get file content from repository
    operationId: getRepositoryFile
    parameters:
      - name: repository
        in: query
        required: true
        description: Repository path
        schema:
          type: string
      - name: path
        in: query
        required: true
        description: File path within repository
        schema:
          type: string
      - name: format
        in: query
        required: false
        description: Response format
        schema:
          type: string
          enum: [text, html, json]
          default: text
    responses:
      '200':
        description: File content retrieved successfully
        content:
          text/plain:
            schema:
              type: string
          text/html:
            schema:
              type: string
          application/json:
            schema:
              $ref: '../components/schemas/index.yaml#/FileContent'
      '400':
        $ref: '../components/responses/index.yaml#/BadRequest'
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '404':
        $ref: '../components/responses/index.yaml#/NotFound'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'

/api/repositories/watch:
  post:
    tags:
      - repositories
    summary: Start watching a repository for changes
    operationId: watchRepository
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              repository:
                type: string
                description: Repository path to watch
              options:
                type: object
                properties:
                  ignored:
                    type: array
                    items:
                      type: string
                    description: Patterns to ignore
                  depth:
                    type: integer
                    description: Maximum depth to watch
            required:
              - repository
    responses:
      '200':
        description: Repository watch started successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                repository:
                  type: string
                watching:
                  type: boolean
      '400':
        $ref: '../components/responses/index.yaml#/BadRequest'
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'

  delete:
    tags:
      - repositories
    summary: Stop watching a repository
    operationId: unwatchRepository
    parameters:
      - name: repository
        in: query
        required: true
        description: Repository path to stop watching
        schema:
          type: string
    responses:
      '200':
        description: Repository watch stopped successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                repository:
                  type: string
      '400':
        $ref: '../components/responses/index.yaml#/BadRequest'
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '404':
        $ref: '../components/responses/index.yaml#/NotFound'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'

/api/repositories/watched:
  get:
    tags:
      - repositories
    summary: List watched repositories
    operationId: listWatchedRepositories
    responses:
      '200':
        description: Watched repositories retrieved successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                repositories:
                  type: array
                  items:
                    type: string
      '401':
        $ref: '../components/responses/index.yaml#/Unauthorized'
      '500':
        $ref: '../components/responses/index.yaml#/InternalServerError'